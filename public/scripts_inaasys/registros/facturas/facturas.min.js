"use strict";var tabla,form,contadorfilasfacturas=0;function init(){listar()}function retraso(){return new Promise(a=>setTimeout(a,1500))}function asignarfechaactual(){$.get(ordenes_compra_obtener_fecha_actual_datetimelocal,function(a){$("#fecha").val(a),$("input[type=datetime-local]").val(a)})}function obtenultimonumero(){var a=$("#serie").val();$.get(facturas_obtener_ultimo_folio,{serie:a},function(a){$("#folio").val(a)})}function obtenertiposordenescompra(){$.get(facturas_obtener_tipos,function(a){$("#tipo").html(a)})}function obtenertiposunidades(){$.get(facturas_obtener_tipos_unidades,function(a){$("#tipounidad").html(a)})}function limpiarmodales(){$("#tabsform").empty()}function limpiar(){$("#formparsley")[0].reset(),(form=$("#formparsley")).parsley().reset(),regresarbusquedadatatableprincipal()}function mostrarmodalformulario(a,e){$("#ModalFormulario").modal("show"),"ALTA"==a?($("#btnGuardar").show(),$("#btnGuardarModificacion").hide()):"MODIFICACION"==a&&(0==e?($("#btnGuardar").hide(),$("#btnGuardarModificacion").hide()):($("#btnGuardar").hide(),$("#btnGuardarModificacion").show()))}function ocultarmodalformulario(){$("#ModalFormulario").modal("hide")}function mostrarformulario(){$("#formulario").show(),$("#contenidomodaltablas").hide()}function ocultarformulario(){$("#formulario").hide(),$("#contenidomodaltablas").show()}function cambiarurlexportarexcel(){var a=$("#periodo").val();$("#btnGenerarFormatoExcel").attr("href",urlgenerarformatoexcel+"?periodo="+a)}function relistar(){$(".tbllistado").DataTable().ajax.reload(),cambiarurlexportarexcel()}function listar(){cambiarurlexportarexcel();var a=columnas_ordenadas.split(","),e=[];e.push({data:"operaciones",name:"operaciones",orderable:!1,searchable:!1});for(var o=0;o<a.length;o++){var t=!1;"Factura"!=a[o]&&"Status"!=a[o]&&"UUID"!=a[o]&&"NombreCliente"!=a[o]&&"RfcCliente"!=a[o]||(t=!0),e.push({data:a[o],name:a[o],orderable:!1,searchable:t})}tabla=$("#tbllistado").DataTable({lengthMenu:[100,250,500,1e3],pageLength:100,sScrollX:"110%",sScrollY:"350px",processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener,data:function(a){a.periodo=$("#periodo").val()}},createdRow:function(a,e,o){"BAJA"==e.Status?$(a).addClass("bg-orange"):"POR COBRAR"==e.Status&&$(a).addClass("bg-red")},columns:e,initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistado").DataTable().search(this.value).draw()})}})}function obtenerclientes(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Clientes</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadocliente" class="tbllistadocliente table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Numero</th><th>Nombre</th><th>R.F.C.</th><th>Municipio</th><th>Agente</th><th>Tipo</th><th>Saldo $</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadocliente").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_clientes},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Numero",name:"Numero"},{data:"Nombre",name:"Nombre"},{data:"Rfc",name:"Rfc",orderable:!1,searchable:!1},{data:"Municipio",name:"Municipio",orderable:!1,searchable:!1},{data:"Agente",name:"Agente",orderable:!1,searchable:!1},{data:"Tipo",name:"Tipo",orderable:!1,searchable:!1},{data:"Saldo",name:"Saldo",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadocliente").DataTable().search(this.value).draw()})}})}function seleccionarcliente(a,e,o,t,l,r,i,s,d,n,c,m,u,p,b){var v;$("#numeroclienteanterior").val()!=a&&(v=$("#numerofilas").val(),1==(!(0<parseInt(v))||confirm("Esta seguro de cambiar el cliente, esto eliminara las partidas agregadas (Remisiones ó Servicios)?"))&&($("#tabladetallesfactura tbody").html(""),$("#numerocliente").val(a),$("#numeroclienteanterior").val(a),$("#cliente").val(e),null!=e&&$("#textonombrecliente").html(e.substring(0,40)),$("#rfccliente").val(t),$("#plazo").val(o),$("#credito").val(number_format(round(p,numerodecimales),numerodecimales,".","")),$("#saldo").val(number_format(round(b,numerodecimales),numerodecimales,".","")),$("#receptorrfc").val(t),$("#receptornombre").val(e),$("#claveformapago").val(l),$("#claveformapagoanterior").val(l),$("#formapago").val(r),null!=r&&$("#textonombreformapago").html(r.substring(0,40)),$("#clavemetodopago").val(i),$("#clavemetodopagoanterior").val(i),$("#metodopago").val(s),null!=s&&$("#textonombremetodopago").html(s.substring(0,40)),$("#claveusocfdi").val(d),$("#claveusocfdianterior").val(d),$("#usocfdi").val(n),null!=n&&$("#textonombreusocfdi").html(n.substring(0,40)),$("#claveresidenciafiscal").val(c),$("#claveresidenciafiscalanterior").val(c),$("#residenciafiscal").val(m),null!=m&&$("#textonombreresidenciafiscal").html(m.substring(0,40)),$.get(facturas_obtener_datos_agente,{NumeroAgente:u},function(a){$("#numeroagente").val(a.Numero),$("#numeroagenteanterior").val(a.Numero),$("#rfcagente").val(a.Rfc),$("#agente").val(a.Nombre),null!=a.Nombre&&$("#textonombreagente").html(a.Nombre.substring(0,40))}),comprobartiposerie($("#depto").val()),comprobarfilas(),calculartotal(),$("#stringremisionesseleccionadas").val(""),$("#stringordenesseleccionadas").val(""),contadorfilas=contadorproductos=0,partida=1,mostrarformulario()))}function obteneragentes(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Agentes</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoagente" class="tbllistadoagente table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Numero</th><th>Nombre</th><th>Rfc</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoagente").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_agentes},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Numero",name:"Numero"},{data:"Nombre",name:"Nombre"},{data:"Rfc",name:"Rfc"}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoagente").DataTable().search(this.value).draw()})}})}function seleccionaragente(a,e,o){$("#numeroagenteanterior").val()!=a&&($("#numeroagente").val(a),$("#numeroagenteanterior").val(a),$("#rfcagente").val(o),$("#agente").val(e),null!=e&&$("#textonombreagente").html(e.substring(0,40)),mostrarformulario())}function obtenerlugaresexpedicion(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Códigos Postales</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadocodigopostal" class="tbllistadocodigopostal table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Estado</th><th>Municipio</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadocodigopostal").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_codigos_postales,data:function(a){}},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Estado",name:"Estado",orderable:!1,searchable:!1},{data:"Municipio",name:"Municipio",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadocodigopostal").DataTable().search(this.value).draw()})}})}function seleccionarlugarexpedicion(a,e){$("#lugarexpedicionanterior").val()!=a&&($("#lugarexpedicion").val(a),$("#lugarexpedicionanterior").val(a),$("#textonombrelugarexpedicion").val(e),mostrarformulario())}function obtenerregimenesfiscales(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Regimenes Fiscales</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoregimenfiscal" class="tbllistadoregimenfiscal table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th><th>Física</th><th>Moral</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoregimenfiscal").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_regimenes_fiscales},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre",orderable:!1,searchable:!1},{data:"Fisica",name:"Fisica",orderable:!1,searchable:!1},{data:"Moral",name:"Moral",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoregimenfiscal").DataTable().search(this.value).draw()})}})}function seleccionarregimenfiscal(a,e){$("#claveregimenfiscalanterior").val()!=a&&($("#claveregimenfiscal").val(a),$("#claveregimenfiscalanterior").val(a),$("#regimenfiscal").val(e),null!=e&&$("#textonombreregimenfiscal").html(e.substring(0,40)),mostrarformulario())}function obtenertiposrelaciones(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Tipos Relación</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadotiporelacion" class="tbllistadotiporelacion table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadotiporelacion").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_tipos_relacion},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadotiporelacion").DataTable().search(this.value).draw()})}})}function seleccionartiporelacion(a,e){$("#clavetiporelacionanterior").val()!=a&&($("#clavetiporelacion").val(a),$("#clavetiporelacionanterior").val(a),$("#tiporelacion").val(e),null!=e&&$("#textonombretiporelacion").html(e.substring(0,40)),mostrarformulario())}function obtenerformaspago(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Formas Pago</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoformapago" class="tbllistadoformapago table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th><th>Descripción</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoformapago").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_formas_pago},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre",orderable:!1,searchable:!1},{data:"Descripcion",name:"Descripcion",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoformapago").DataTable().search(this.value).draw()})}})}function seleccionarformapago(a,e){$("#claveformapagoanterior").val()!=a&&($("#claveformapago").val(a),$("#claveformapagoanterior").val(a),$("#formapago").val(e),null!=e&&$("#textonombreformapago").html(e.substring(0,40)),mostrarformulario())}function obtenermetodospago(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Métodos Pago</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadometodopago" class="tbllistadometodopago table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadometodopago").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_metodos_pago},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadometodopago").DataTable().search(this.value).draw()})}})}function seleccionarmetodopago(a,e){$("#clavemetodopagoanterior").val()!=a&&($("#clavemetodopago").val(a),$("#clavemetodopagoanterior").val(a),$("#metodopago").val(e),null!=e&&$("#textonombremetodopago").html(e.substring(0,40)),mostrarformulario())}function obtenerusoscfdi(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Usos CFDI</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadousocfdi" class="tbllistadousocfdi table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th><th>Fisica</th><th>Moral</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadousocfdi").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_usos_cfdi},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre",orderable:!1,searchable:!1},{data:"Fisica",name:"Fisica",orderable:!1,searchable:!1},{data:"Moral",name:"Moral",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadousocfdi").DataTable().search(this.value).draw()})}})}function seleccionarusocfdi(a,e){$("#claveusocfdianterior").val()!=a&&($("#claveusocfdi").val(a),$("#claveusocfdianterior").val(a),$("#usocfdi").val(e),null!=e&&$("#textonombreusocfdi").html(e.substring(0,40)),mostrarformulario())}function obtenerresidenciasfiscales(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Residencias Fiscales</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoresidencialfiscal" class="tbllistadoresidencialfiscal table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoresidencialfiscal").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_residencias_fiscales},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoresidencialfiscal").DataTable().search(this.value).draw()})}})}function seleccionarresidenciafiscal(a,e){$("#claveresidenciafiscalanterior").val()!=a&&($("#claveresidenciafiscal").val(a),$("#claveresidenciafiscalanterior").val(a),$("#residenciafiscal").val(e),null!=e&&$("#textonombreresidenciafiscal").html(e.substring(0,40)),mostrarformulario())}function obtenerfoliosfacturas(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Folios Fiscales</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadofoliofiscal" class="tbllistadofoliofiscal table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Serie</th><th>Esquema</th><th>Depto</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadofoliofiscal").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_folios_fiscales},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Serie",name:"Serie"},{data:"Esquema",name:"Esquema",orderable:!1,searchable:!1},{data:"Depto",name:"Depto",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadofoliofiscal").DataTable().search(this.value).draw()})}})}function seleccionarfoliofiscal(e,o,t){var a=$("#numerofilas").val();1==(!(0<parseInt(a))||confirm("Esta seguro de cambiar el folio fiscal, esto eliminara las partidas agregadas (Remisiones ó Servicios)?"))&&$.get(facturas_obtener_ultimo_folio_serie_seleccionada,{Serie:e,Esquema:o,Depto:t},function(a){$("#tabladetallesfactura tbody").html(""),$("#folio").val(a),$("#serie").val(e),$("#esquema").val(o),$("#depto").val(t),$("#serietexto").html("Serie: "+e),$("#esquematexto").html("Esquema: "+o),comprobartiposerie(t),comprobarfilas(),calculartotal(),$("#stringremisionesseleccionadas").val(""),$("#stringordenesseleccionadas").val(""),contadorfilas=contadorproductos=0,partida=1,mostrarformulario()})}function comprobartiposerie(a){""!=$("#cliente").val()&&("PRODUCTOS"==a?($("#divlistarremisiones").show(),$("#divlistarservicios").hide(),$("#divbuscarcodigos").hide()):"SERVICIO"==a?($("#divlistarremisiones").hide(),$("#divlistarservicios").show(),$("#divbuscarcodigos").hide()):($("#divlistarremisiones").hide(),$("#divlistarservicios").hide(),$("#divbuscarcodigos").show()))}function listarremisiones(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Facturar Remisiones</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoremision" class="tbllistadoremision table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Remisión</th><th>Fecha</th><th>Cliente</th><th>Nombre</th><th>Facturar $</th><th>Plazo</th><th>Pedido</th><th>Selecciona</th></tr></thead><tbody></tbody></table></div></div></div><div class="row"><div class="col-md-6 col-md-offset-4"></div><div class="col-md-2"><label>Total $</label><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="totalafacturar" id="totalafacturar" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoremision").DataTable({searching:!1,paging:!1,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_remisiones,data:function(a){a.numerocliente=$("#numerocliente").val(),a.stringremisionesseleccionadas=$("#stringremisionesseleccionadas").val()}},columns:[{data:"Remision",name:"Remision"},{data:"Fecha",name:"Fecha"},{data:"Cliente",name:"Cliente",orderable:!1,searchable:!1},{data:"NombreCliente",name:"NombreCliente",orderable:!1,searchable:!1},{data:"Facturar",name:"Facturar",orderable:!1,searchable:!1},{data:"Plazo",name:"Plazo",orderable:!1,searchable:!1},{data:"Pedido",name:"Pedido",orderable:!1,searchable:!1},{data:"Selecciona",name:"Selecciona",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoremision").DataTable().search(this.value).draw()})},iDisplayLength:1e3,order:[[0,"desc"]]})}function construirarrayremisionesseleccionadas(){for(var a=[],e=document.getElementsByClassName("remisionesseleccionadas"),o=0;o<e.length;o++)e[o].checked&&a.push(e[o].value);$("#stringremisionesseleccionadas").val(a)}function seleccionarremision(a){var e;$("#idremisionesseleccionadas"+a).prop("checked")?(e=$("#tipooperacion").val(),$.get(facturas_obtener_remision,{Remision:a,contadorfilas:contadorfilas,partida:partida,tipooperacion:e},function(a){$("#tabladetallesfactura tbody").append(a.filasremisiones),construirarrayremisionesseleccionadas(),comprobarfilas(),calculartotal(),contadorfilas=a.contadorfilas,partida=a.partida,remisionagregadacorrectamente()})):1==confirm("Esta seguro de eliminar las partidas de la remisión?")&&eliminarfilasremisiondeseleccionada(a)}function eliminarfilasremisiondeseleccionada(a){var e=0;$("tr.filasproductos").each(function(){$(".remisionpartida",this).val()==a&&eliminarfila(e).then(a=>{}),e++}),msjsuccesseliminacionpartidasremision()}async function msjsuccesseliminacionpartidasremision(){await retraso(),remisioneliminadacorrectamente(),construirarrayremisionesseleccionadas(),renumerarfilas(),comprobarfilas(),calculartotal()}function listarordenes(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Facturar Servicios</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoorden" class="tbllistadoorden table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Orden</th><th>Fecha</th><th>Cliente</th><th>Nombre</th><th>Por Facturar $</th><th>Total Orden</th><th>Tipo</th><th>Selecciona</th></tr></thead><tbody></tbody></table></div></div></div><div class="row"><div class="col-md-6 col-md-offset-4"></div><div class="col-md-2"><label>Total $</label><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="totalafacturar" id="totalafacturar" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoorden").DataTable({searching:!1,paging:!1,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_ordenes,data:function(a){a.numerocliente=$("#numerocliente").val(),a.stringordenesseleccionadas=$("#stringordenesseleccionadas").val()}},columns:[{data:"Orden",name:"Orden"},{data:"Fecha",name:"Fecha"},{data:"Cliente",name:"Cliente",orderable:!1,searchable:!1},{data:"NombreCliente",name:"NombreCliente",orderable:!1,searchable:!1},{data:"Facturar",name:"Facturar",orderable:!1,searchable:!1},{data:"Total",name:"Total",orderable:!1,searchable:!1},{data:"Tipo",name:"Tipo",orderable:!1,searchable:!1},{data:"Selecciona",name:"Selecciona",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoorden").DataTable().search(this.value).draw()})},iDisplayLength:1e3,order:[[0,"desc"]]})}function construirarrayordenesseleccionadas(){for(var a=[],e=document.getElementsByClassName("ordenesseleccionadas"),o=0;o<e.length;o++)e[o].checked&&a.push(e[o].value);$("#stringordenesseleccionadas").val(a)}function seleccionarorden(a){var e;$("#idordenesseleccionadas"+a).prop("checked")?(e=$("#tipooperacion").val(),$.get(facturas_obtener_orden,{Orden:a,contadorfilas:contadorfilas,partida:partida,tipooperacion:e},function(a){$("#tabladetallesfactura tbody").append(a.filasordenes),construirarrayordenesseleccionadas(),comprobarfilas(),calculartotal(),contadorfilas=a.contadorfilas,partida=a.partida,ordenagregadacorrectamente()})):1==confirm("Esta seguro de eliminar las partidas de la orden?")&&eliminarfilasordendeseleccionada(a)}function eliminarfilasordendeseleccionada(a){var e=0;$("tr.filasproductos").each(function(){$(".ordenpartida",this).val()==a&&eliminarfila(e).then(a=>{}),e++}),msjsuccesseliminacionpartidasorden()}async function msjsuccesseliminacionpartidasorden(){await retraso(),ordeneliminadacorrectamente(),construirarrayordenesseleccionadas(),renumerarfilas(),comprobarfilas(),calculartotal()}function obtenerclientepornumero(){var a=$("#numeroclienteanterior").val(),e=$("#numerocliente").val();a!=e&&$("#numerocliente").parsley().isValid()&&$.get(facturas_obtener_cliente_por_numero,{numerocliente:e},function(a){var e=$("#numerofilas").val();1==(!(0<parseInt(e))||confirm("Esta seguro de cambiar el cliente, esto eliminara las partidas agregadas (Remisiones ó Servicios)?"))&&($("#tabladetallesfactura tbody").html(""),$("#numerocliente").val(a.numero),$("#numeroclienteanterior").val(a.numero),$("#cliente").val(a.nombre),null!=a.nombre&&$("#textonombrecliente").html(a.nombre.substring(0,40)),$("#rfccliente").val(a.rfc),$("#plazo").val(a.plazo),$("#credito").val(number_format(round(a.credito,numerodecimales),numerodecimales,".","")),$("#saldo").val(number_format(round(a.saldo,numerodecimales),numerodecimales,".","")),$("#receptorrfc").val(a.rfc),$("#receptornombre").val(a.nombre),$("#claveformapago").val(a.claveformapago),$("#claveformapagoanterior").val(a.claveformapago),$("#formapago").val(a.formapago),null!=a.formapago&&$("#textonombreformapago").html(a.formapago.substring(0,40)),$("#clavemetodopago").val(a.clavemetodopago),$("#clavemetodopagoanterior").val(a.clavemetodopago),$("#metodopago").val(a.metodopago),null!=a.metodopago&&$("#textonombremetodopago").html(a.metodopago.substring(0,40)),$("#claveusocfdi").val(a.claveusocfdi),$("#claveusocfdianterior").val(a.claveusocfdi),$("#usocfdi").val(a.usocfdi),null!=a.usocfdi&&$("#textonombreusocfdi").html(a.usocfdi.substring(0,40)),$("#claveresidenciafiscal").val(a.claveresidenciafiscal),$("#claveresidenciafiscalanterior").val(a.claveresidenciafiscal),$("#residenciafiscal").val(a.residenciafiscal),null!=a.residenciafiscal&&$("#textonombreresidenciafiscal").html(a.residenciafiscal.substring(0,40)),$("#numeroagente").val(a.numeroagente),$("#numeroagenteanterior").val(a.numeroagente),$("#rfcagente").val(a.rfcagente),$("#agente").val(a.nombreagente),null!=a.nombreagente&&$("#textonombreagente").html(a.nombreagente.substring(0,40)),comprobartiposerie($("#depto").val()),comprobarfilas(),calculartotal(),$("#stringremisionesseleccionadas").val(""),$("#stringordenesseleccionadas").val(""),contadorfilas=contadorproductos=0,partida=1,mostrarformulario())})}function regresarnumerocliente(){var a=$("#numeroclienteanterior").val();$("#numerocliente").val(a)}function obteneragentepornumero(){var a=$("#numeroagenteanterior").val(),e=$("#numeroagente").val();a!=e&&$("#numeroagente").parsley().isValid()&&$.get(facturas_obtener_agente_por_numero,{numeroagente:e},function(a){$("#numeroagente").val(a.numero),$("#numeroagenteanterior").val(a.numero),$("#rfcagente").val(a.rfc),$("#agente").val(a.nombre),null!=a.nombre&&$("#textonombreagente").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarnumeroagente(){var a=$("#numeroagenteanterior").val();$("#numeroagente").val(a)}function obtenerlugarexpedicionporclave(){var a=$("#lugarexpedicionanterior").val(),e=$("#lugarexpedicion").val();a!=e&&$("#lugarexpedicion").parsley().isValid()&&$.get(facturas_obtener_lugar_expedicion_por_clave,{lugarexpedicion:e},function(a){$("#lugarexpedicion").val(a.clave),$("#lugarexpedicionanterior").val(a.clave),null!=a.estado&&$("#textonombrelugarexpedicion").html(a.estado.substring(0,40)),mostrarformulario()})}function regresarclavelugarexpedicion(){var a=$("#lugarexpedicionanterior").val();$("#lugarexpedicion").val(a)}function obtenerregimenfiscalporclave(){var a=$("#claveregimenfiscalanterior").val(),e=$("#claveregimenfiscal").val();a!=e&&$("#claveregimenfiscal").parsley().isValid()&&$.get(facturas_obtener_regimen_fiscal_por_clave,{claveregimenfiscal:e},function(a){$("#claveregimenfiscal").val(a.clave),$("#claveregimenfiscalanterior").val(a.clave),$("#regimenfiscal").val(a.nombre),null!=a.nombre&&$("#textonombreregimenfiscal").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarclaveregimenfiscal(){var a=$("#claveregimenfiscalanterior").val();$("#claveregimenfiscal").val(a)}function obtenertiporelacionporclave(){var a=$("#clavetiporelacionanterior").val(),e=$("#clavetiporelacion").val();a!=e&&$("#clavetiporelacion").parsley().isValid()&&$.get(facturas_obtener_tipo_relacion_por_clave,{clavetiporelacion:e},function(a){$("#clavetiporelacion").val(a.clave),$("#clavetiporelacionanterior").val(a.clave),$("#tiporelacion").val(a.nombre),null!=a.nombre&&$("#textonombretiporelacion").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarclavetiporelacion(){var a=$("#clavetiporelacionanterior").val();$("#clavetiporelacion").val(a)}function obtenerformapagoporclave(){var a=$("#claveformapagoanterior").val(),e=$("#claveformapago").val();a!=e&&$("#claveformapago").parsley().isValid()&&$.get(facturas_obtener_forma_pago_por_clave,{claveformapago:e},function(a){$("#claveformapago").val(a.clave),$("#claveformapagoanterior").val(a.clave),$("#formapago").val(a.nombre),null!=a.nombre&&$("#textonombreformapago").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarclaveformapago(){var a=$("#claveformapagoanterior").val();$("#claveformapago").val(a)}function obtenermetodopagoporclave(){var a=$("#clavemetodopagoanterior").val(),e=$("#clavemetodopago").val();a!=e&&$("#clavemetodopago").parsley().isValid()&&$.get(facturas_obtener_metodo_pago_por_clave,{clavemetodopago:e},function(a){$("#clavemetodopago").val(a.clave),$("#clavemetodopagoanterior").val(a.clave),$("#metodopago").val(a.nombre),null!=a.nombre&&$("#textonombremetodopago").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarclavemetodopago(){var a=$("#clavemetodopagoanterior").val();$("#clavemetodopago").val(a)}function obtenerusocfdiporclave(){var a=$("#claveusocfdianterior").val(),e=$("#claveusocfdi").val();a!=e&&$("#claveusocfdi").parsley().isValid()&&$.get(facturas_obtener_uso_cfdi_por_clave,{claveusocfdi:e},function(a){$("#claveusocfdi").val(a.clave),$("#claveusocfdianterior").val(a.clave),$("#usocfdi").val(a.nombre),null!=a.nombre&&$("#textonombreusocfdi").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarclaveusocfdi(){var a=$("#claveusocfdianterior").val();$("#claveusocfdi").val(a)}function obtenerresidenciafiscalporclave(){var a=$("#claveresidenciafiscalanterior").val(),e=$("#claveresidenciafiscal").val();a!=e&&$("#claveresidenciafiscal").parsley().isValid()&&$.get(facturas_obtener_residencia_fiscal_por_clave,{claveresidenciafiscal:e},function(a){$("#claveresidenciafiscal").val(a.clave),$("#claveresidenciafiscalanterior").val(a.clave),$("#residenciafiscal").val(a.nombre),null!=a.nombre&&$("#textonombreresidenciafiscal").html(a.nombre.substring(0,40)),mostrarformulario()})}function regresarclaveresidenciafiscal(){var a=$("#claveresidenciafiscalanterior").val();$("#claveresidenciafiscal").val(a)}function listarproductos(){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Productos</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoproducto" class="tbllistadoproducto table table-bordered table-striped table-hover" style="width:100% !important"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Código</th><th>Marca</th><th>Producto</th><th>Ubicación</th><th>Existencias</th><th>Almacen</th><th>Costo $</th><th>Sub Total $</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoproducto").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_productos,data:function(a){a.codigoabuscar=$("#codigoabuscar").val(),a.tipooperacion=$("#tipooperacion").val()}},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Codigo",name:"Codigo"},{data:"Marca",name:"Marca",orderable:!1,searchable:!1},{data:"Producto",name:"Producto"},{data:"Ubicacion",name:"Ubicacion",orderable:!1,searchable:!1},{data:"Existencias",name:"Existencias",orderable:!1,searchable:!1},{data:"Almacen",name:"Almacen",orderable:!1,searchable:!1},{data:"Costo",name:"Costo",orderable:!1,searchable:!1},{data:"SubTotal",name:"SubTotal",orderable:!1,searchable:!1}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoproducto").DataTable().search(this.value).draw()})}})}function listarclavesproductos(e){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Claves Productos</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoclaveproducto" class="tbllistadoclaveproducto table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoclaveproducto").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_claves_productos,data:function(a){a.fila=e}},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre"}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoclaveproducto").DataTable().search(this.value).draw()})}})}function seleccionarclaveproducto(a,e,o){$("#filaproducto"+o+" .claveproductopartida").val(a),$("#filaproducto"+o+" .nombreclaveproductopartida").val(e),mostrarformulario()}function listarclavesunidades(e){ocultarformulario();var a='<div class="modal-header '+background_forms_and_modals+'"><h4 class="modal-title">Claves Unidades</h4></div><div class="modal-body"><div class="row"><div class="col-md-12"><div class="table-responsive"><table id="tbllistadoclaveunidad" class="tbllistadoclaveunidad table table-bordered table-striped table-hover" style="width:100% !important;"><thead class="'+background_tables+'"><tr><th>Operaciones</th><th>Clave</th><th>Nombre</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-sm" onclick="mostrarformulario();">Regresar</button></div>';$("#contenidomodaltablas").html(a),$("#tbllistadoclaveunidad").DataTable({lengthMenu:[10,50,100,250,500],pageLength:250,sScrollX:"110%",sScrollY:"370px",bScrollCollapse:!0,processing:!0,language:{loadingRecords:"&nbsp;",processing:'<div class="spinner"></div>'},serverSide:!0,ajax:{url:facturas_obtener_claves_unidades,data:function(a){a.fila=e}},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Clave",name:"Clave"},{data:"Nombre",name:"Nombre"}],initComplete:function(){var a=$("div.dataTables_filter input");a.unbind(),a.bind("keyup change",function(a){13!=a.keyCode&&""!=this.value||$("#tbllistadoclaveunidad").DataTable().search(this.value).draw()})}})}function seleccionarclaveunidad(a,e,o){$("#filaproducto"+o+" .claveunidadpartida").val(a),$("#filaproducto"+o+" .nombreclaveunidadpartida").val(e),mostrarformulario()}function evaluarproductoexistente(e){var o=0,t=0,l=0;return $("tr.filasproductos").each(function(){var a=$(".codigopartida",this).val();e===a?o++:t++,l++}),parseInt(t)-parseInt(o)!=l}$(document).ready(function(){$("#codigoabuscar").keypress(function(a){13==(a.keyCode||a.which)&&listarproductos()})});var contadorproductos=0,contadorfilas=0,partida=1;function agregarfilaproducto(a,e,o,t,l,r,i,s,d,n,c,m,u){var p,b,v;$(".page-loader-wrapper").css("display","block"),0==evaluarproductoexistente(a)?(v=new Decimal(r).times(l),p=new Decimal(v/100),b=new Decimal(r).plus(p),v=r,r=new Decimal(r).minus(t),m='<tr class="filasproductos" id="filaproducto'+contadorfilas+'"><td class="tdmod"><div class="numeropartida">'+partida+'</div><input type="hidden" class="form-control agregadoen" name="agregadoen[]" value="'+i+'" readonly></td><td class="tdmod"><input type="hidden" class="form-control codigopartida" name="codigopartida[]" value="'+a+'" readonly data-parsley-length="[1, 20]">'+a+'</td><td class="tdmod"><input type="text" class="form-control divorinputmodxl descripcionpartida" name="descripcionpartida[]" value="'+e+'" data-parsley-length="[1, 255]"></td><td class="tdmod"><input type="text" class="form-control divorinputmodxs unidadpartida" name="unidadpartida[]" value="'+o+'" data-parsley-length="[1, 5]"></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm cantidadpartida" name="cantidadpartida[]" value="1.'+numerocerosconfigurados+'" data-parsley-min="0.1" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);calculartotalesfilas('+contadorfilas+');"><input type="hidden" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm cantidadpartidadb" name="cantidadpartidadb[]" value="1.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);" readonly><input type="hidden" class="form-control cantidadincorrecta" name="cantidadincorrecta[]" ><input type="hidden" class="form-control realizarbusquedaexistencias" name="realizarbusquedaexistencias[]" value="1" ><div class="cantidaderrorexistencias" style="color:#dc3545;font-size:9px; display:none"></div></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm preciopartida" name="preciopartida[]" value="'+v+'" data-parsley-min="0.1" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);calculartotalesfilas('+contadorfilas+');"></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm importepartida" name="importepartida[]" value="'+v+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm descuentoporcentajepartida" name="descuentoporcentajepartida[]" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);calculardescuentopesospartida('+contadorfilas+');"></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm descuentopesospartida" name="descuentopesospartida[]" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);calculardescuentoporcentajepartida('+contadorfilas+');"></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm importedescuentopesospartida" name="importedescuentopesospartida[]" value="'+v+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm subtotalpartida" name="subtotalpartida[]" value="'+v+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm ivaporcentajepartida" name="ivaporcentajepartida[]" value="'+l+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);calculartotalesfilas('+contadorfilas+');"></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm trasladoivapesospartida" name="trasladoivapesospartida[]" value="'+number_format(round(p,numerodecimales),numerodecimales,".","")+'"  data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm totalpesospartida" name="totalpesospartida[]" value="'+number_format(round(b,numerodecimales),numerodecimales,".","")+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm costopartida" name="costopartida[]" value="'+t+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm costototalpartida" name="costototalpartida[]" value="'+t+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm comisionporcentajepartida" name="comisionporcentajepartida[]" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);calculardescuentopesospartida('+contadorfilas+');" required></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm comisionpesospartida" name="comisionpesospartida[]" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);" readonly required></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm utilidadpartida" name="utilidadpartida[]" value="'+number_format(round(r,numerodecimales),numerodecimales,".","")+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm remisionpartida" name="remisionpartida[]"  value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm cartaportepartida" name="cartaportepartida[]"  value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm ordenpartida" name="ordenpartida[]"  value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm departamentopartida" name="departamentopartida[]"  value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm cargopartida" name="cargopartida[]"  value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm partida" name="partida[]" value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm tiendapartida" name="tiendapartida[]"  value=""></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm pedidopartida" name="pedidopartida[]"  value=""></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm almacenpartida" name="almacenpartida[]"  value="" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm datosunidadpartida" name="datosunidadpartida[]"  value="" readonly></td><td class="tdmod" hidden><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm utilidadaritmeticapartida" name="utilidadaritmeticapartida[]" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod" hidden><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm utilidadfinancieriapartida" name="utilidadfinancieriapartida[]" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="text" class="form-control divorinputmodsm monedapartida" name="monedapartida[]" value="MXN" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm costodelistapartida" name="costodelistapartida[]" value="'+u+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodsm tipocambiopartida" name="tipocambiopartida[]" value="1.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" readonly></td><td class="tdmod"><div class="row divorinputmodxl"><div class="col-xs-2 col-sm-2 col-md-2"><div class="btn bg-blue btn-xs waves-effect btnlistarclavesproductos" data-toggle="tooltip" title="Ver Claves Productos o Servicios" onclick="listarclavesproductos('+contadorfilas+');" ><i class="material-icons">remove_red_eye</i></div></div><div class="col-xs-10 col-sm-10 col-md-10"><input type="text" class="form-control divorinputmodsm claveproductopartida" name="claveproductopartida[]"  value="'+d+'" readonly data-parsley-length="[1, 20]"></div></div></td><td class="tdmod"><input type="text" class="form-control divorinputmodmd nombreclaveproductopartida" name="nombreclaveproductopartida[]"  value="'+c+'" readonly></td><td class="tdmod"><div class="row divorinputmodxl"><div class="col-xs-2 col-sm-2 col-md-2"><div class="btn bg-blue btn-xs waves-effect btnlistarclavesunidades" data-toggle="tooltip" title="Ver Claves Unidades" onclick="listarclavesunidades('+contadorfilas+');" ><i class="material-icons">remove_red_eye</i></div></div><div class="col-xs-10 col-sm-10 col-md-10"><input type="text" class="form-control divorinputmodsm claveunidadpartida" name="claveunidadpartida[]"  value="'+n+'" readonly data-parsley-length="[1, 5]"></div></div></td><td class="tdmod"><input type="text" class="form-control divorinputmodmd nombreclaveunidadpartida" name="nombreclaveunidadpartida[]"  value="'+m+'" readonly></td></tr>',contadorproductos++,contadorfilas++,$("#tabladetallesfactura").append(m),mostrarformulario(),comprobarfilas(),calculartotal(),$("#codigoabuscar").val("")):msj_errorproductoyaagregado(),$(".page-loader-wrapper").css("display","none")}function alta(){$("#titulomodal").html("Alta Factura"),mostrarmodalformulario("ALTA",1),mostrarformulario();var a='<div class="row"><div class="col-md-12"><ul class="nav nav-tabs tab-col-blue-grey" role="tablist"><li role="presentation" class="active"><a href="#facturatab" data-toggle="tab">Factura</a></li><li role="presentation"><a href="#emisortab" data-toggle="tab">Emisor</a></li><li role="presentation"><a href="#receptortab" data-toggle="tab">Receptor ó Cliente</a></li><li role="presentation"><a href="#otrostab" data-toggle="tab">Otros</a></li></ul><div class="tab-content"><div role="tabpanel" class="tab-pane fade in active" id="facturatab"><div class="row"><div class="col-md-3"><label>Factura <b style="color:#F44336 !important;" id="serietexto"> Serie: '+serieusuario+'</b> &nbsp;&nbsp;<b style="color:#F44336 !important;" id="esquematexto"> Esquema: '+esquema+'</b>  <div class="btn btn-xs bg-red waves-effect" id="btnobtenerfoliosfacturas" onclick="obtenerfoliosfacturas()">Cambiar</div></label><input type="text" class="form-control" name="folio" id="folio" required readonly onkeyup="tipoLetra(this);"><input type="hidden" class="form-control" name="serie" id="serie" value="'+serieusuario+'" required readonly data-parsley-length="[1, 10]"><input type="hidden" class="form-control" name="stringremisionesseleccionadas" id="stringremisionesseleccionadas" readonly required><input type="hidden" class="form-control" name="stringordenesseleccionadas" id="stringordenesseleccionadas" readonly required><input type="hidden" class="form-control" name="tipooperacion" id="tipooperacion" readonly><input type="hidden" class="form-control" name="numerofilas" id="numerofilas" readonly><input type="hidden" class="form-control" name="esquema" id="esquema" value="'+esquema+'" readonly data-parsley-length="[1, 10]"><input type="hidden" class="form-control" name="depto" id="depto" value="'+depto+'" readonly data-parsley-length="[1, 20]"></div><div class="col-md-3"><label>Cliente <span class="label label-danger" id="textonombrecliente"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" id="btnobtenerclientes" onclick="obtenerclientes()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="numerocliente" id="numerocliente" required data-parsley-type="integer"><input type="hidden" class="form-control" name="numeroclienteanterior" id="numeroclienteanterior" required data-parsley-type="integer"><input type="hidden" class="form-control" name="cliente" id="cliente" required readonly><input type="hidden" class="form-control" name="rfccliente" id="rfccliente" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Agente <span class="label label-danger" id="textonombreagente"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" id="btnobteneragentes" onclick="obteneragentes()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="numeroagente" id="numeroagente" required data-parsley-type="integer"><input type="hidden" class="form-control" name="numeroagenteanterior" id="numeroagenteanterior"  required data-parsley-type="integer"><input type="hidden" class="form-control" name="rfcagente" id="rfcagente" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="agente" id="agente" required readonly></div></td></tr></table></div><div class="col-md-1"><label>Plazo días</label><input type="text" class="form-control" name="plazo" id="plazo" value="5" required ></div><div class="col-md-2"><label>Fecha</label><input type="datetime-local" class="form-control" name="fecha" id="fecha" required onchange="validasolomesactual();"><input type="hidden" class="form-control" name="periodohoy" id="periodohoy" value="'+periodohoy+'"><input type="hidden" class="form-control" name="meshoy" id="meshoy" value="'+meshoy+'"></div></div><div class="row"><div class="col-md-2"><table class="col-md-12"><tr><td><label>Moneda</label><select name="moneda" id="moneda" class="form-control select2" style="width:100% !important;" required><option value="MXN">MXN</option><option value="USD">USD</option><option value="EUR">EUR</option></select></td><td><label>Pesos</label><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control" name="pesosmoneda" id="pesosmoneda" value="1.'+numerocerosconfigurados+'" required data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);"></td></tr></table></div><div class="col-md-2"><label>Pedido</label><input type="text" class="form-control" name="pedido" id="pedido" data-parsley-length="[1, 50]"></div><div class="col-md-2"><label>Tipo</label><select id="tipo" name="tipo" class="form-control select2" style="width:100%"></select></div><div class="col-md-2"><label>Unidad</label><select id="tipounidad" name="tipounidad" class="form-control select2" style="width:100%"></select></div><div class="col-md-4" id="divbuscarcodigos"  style="display:none"><label>Escribe el código a buscar y presiona la tecla ENTER</label><input type="text" class="form-control" name="codigoabuscar" id="codigoabuscar" placeholder="Escribe el código del producto" autocomplete="off"></div><div class="col-md-4" id="divlistarremisiones"  style="display:none"><label>Remisiones</label><div class="btn btn-block bg-blue waves-effect" id="btnlistarremisiones" onclick="listarremisiones()">Agregar Remisiones</div></div><div class="col-md-4" id="divlistarservicios"  style="display:none"><label>Servicios</label><div class="btn btn-block bg-blue waves-effect" id="btnlistarservicios" onclick="listarordenes()">Agregar Servicios</div></div></div></div><div role="tabpanel" class="tab-pane fade" id="emisortab"><div class="row"><div class="col-md-4"><label>R.F.C.</label><input type="text" class="form-control" name="emisorrfc" id="emisorrfc" value="'+rfcempresa+'"  required readonly data-parsley-regexrfc="^[A-Z,0-9]{12,13}$" data-parsley-length="[1, 20]" onkeyup="tipoLetra(this);mayusculas(this);"></div><div class="col-md-4"><label>Emisor Nombre</label><input type="text" class="form-control" name="emisornombre" id="emisornombre" value="'+nombreempresa+'" required readonly data-parsley-length="[1, 150]" onkeyup="tipoLetra(this);"></div><div class="col-md-4"><label>Confirmación</label><input type="text" class="form-control" name="confirmacion" id="confirmacion" onkeyup="tipoLetra(this);" data-parsley-length="[1, 20]"></div></div><div class="row"><div class="col-md-4"><label>Lugar Expedición <span class="label label-danger" id="textonombrelugarexpedicion"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerlugaresexpedicion()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="lugarexpedicion" id="lugarexpedicion" value="'+lugarexpedicion+'" required><input type="hidden" class="form-control" name="lugarexpedicionanterior" id="lugarexpedicionanterior" value="'+lugarexpedicion+'" required></div></td></tr></table></div><div class="col-md-4"><label>Régimen Fiscal <span class="label label-danger" id="textonombreregimenfiscal">'+regimenfiscal+'</span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerregimenesfiscales()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveregimenfiscal" id="claveregimenfiscal" value="'+claveregimenfiscal+'" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveregimenfiscalanterior" id="claveregimenfiscalanterior" value="'+claveregimenfiscal+'" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="regimenfiscal" id="regimenfiscal" value="'+regimenfiscal+'" required readonly></div></td></tr></table></div><div class="col-md-4"><label>Tipo Relación <span class="label label-danger" id="textonombretiporelacion"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenertiposrelaciones()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="clavetiporelacion" id="clavetiporelacion" onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="clavetiporelacionanterior" id="clavetiporelacionanterior" onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="tiporelacion" id="tiporelacion"   readonly></div></td></tr></table></div></div><div class="row"><div class="col-md-6"><div class="row"><div class="col-md-12 table-responsive cabecerafija" style="height: 125px;overflow-y: scroll;padding: 0px 0px;"><input type="hidden" class="form-control" name="numerofilasuuid" id="numerofilasuuid" value="0" readonly><table id="tablauuidrelacionados" class="table table-bordered tablauuidrelacionados"><thead class="'+background_tables+'"><tr><th class="customercolortheadth">Comprobante o UUID Relacionado</th><th class="customercolortheadth"><div class="col-md-12"><label for="xml" class="btn btn-success">Selecciona el UUID relacionado</label><input type="file" class="form-control" name="xml" id="xml" onchange="cambiodexml(this)" style="visibility:hidden;display:none;" onclick="this.value=null;" form="formxml"></div></th></tr></thead><tbody></tbody></table></div></div></div></div></div><div role="tabpanel" class="tab-pane fade" id="receptortab"><div class="row"><div class="col-md-3"><label>R.F.C.</label><input type="text" class="form-control" name="receptorrfc" id="receptorrfc"   required readonly data-parsley-regexrfc="^[A-Z,0-9]{12,13}$" data-parsley-length="[1, 20]" onkeyup="tipoLetra(this);mayusculas(this);"></div><div class="col-md-3"><label>Nombre</label><input type="text" class="form-control" name="receptornombre" id="receptornombre"  required readonly onkeyup="tipoLetra(this);" data-parsley-length="[1, 150]"></div><div class="col-md-3"><label>Forma de Pago <span class="label label-danger" id="textonombreformapago"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerformaspago()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveformapago" id="claveformapago" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveformapagoanterior" id="claveformapagoanterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="formapago" id="formapago" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Método de Pago <span class="label label-danger" id="textonombremetodopago"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenermetodospago()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="clavemetodopago" id="clavemetodopago" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="clavemetodopagoanterior" id="clavemetodopagoanterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="metodopago" id="metodopago" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Condiciones de Pago </label><input type="text" class="form-control" name="condicionesdepago" id="condicionesdepago" value="CREDITO" required readonly data-parsley-length="[1, 50]" onkeyup="tipoLetra(this);"></div><div class="col-md-3"><label>Uso CFDI <span class="label label-danger" id="textonombreusocfdi"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerusoscfdi()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveusocfdi" id="claveusocfdi" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveusocfdianterior" id="claveusocfdianterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="usocfdi" id="usocfdi" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Residencia Fiscal <span class="label label-danger" id="textonombreresidenciafiscal"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerresidenciasfiscales()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveresidenciafiscal" id="claveresidenciafiscal" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveresidenciafiscalanterior" id="claveresidenciafiscalanterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="residenciafiscal" id="residenciafiscal" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Num Reg Id Trib</label><input type="text" class="form-control" name="numeroregidtrib" id="numeroregidtrib" data-parsley-length="[1, 40]" onkeyup="tipoLetra(this);"></div></div></div><div role="tabpanel" class="tab-pane fade" id="otrostab"><div class="row"><div class="col-md-4"><label>Tipo PA</label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenertipospa()">Seleccionar</div></td><td><div class="form-line"><input type="hidden" class="form-control" name="numerotipopa" id="numerotipopa"  readonly onkeyup="tipoLetra(this)"><input type="text" class="form-control" name="tipopa" id="tipopa"  readonly></div></td></tr></table></div><div class="col-md-4"><label>Refactura</label><input type="text" class="form-control" name="refactura" id="refactura"  readonly data-parsley-length="[1, 20]" onkeyup="tipoLetra(this);"></div><div class="col-md-4"><label>Descripción</label><textarea class="form-control" name="descripcion" id="descripcion" rows="3" onkeyup="tipoLetra(this);" data-parsley-length="[1, 255]"></textarea></div></div></div></div></div></div><div class="row"><div class="col-md-12"><ul class="nav nav-tabs tab-col-blue-grey" role="tablist"><li role="presentation" class="active"><a href="#productostab" data-toggle="tab">Partidas</a></li></ul><div class="tab-content"><div role="tabpanel" class="tab-pane fade in active" id="productostab"><div class="row"><div class="col-md-12 table-responsive cabecerafija" style="height: 200px;overflow-y: scroll;padding: 0px 0px;"><table id="tabladetallesfactura" class="table table-bordered tabladetallesfactura"><thead class="'+background_tables+'"><tr><th class="'+background_tables+'">#</th><th class="customercolortheadth">Código</th><th class="customercolortheadth"><div style="width:200px !important;">Descripción</div></th><th class="customercolortheadth">Uda</th><th class="customercolortheadth">Cantidad</th><th class="customercolortheadth">Precio $</th><th class="'+background_tables+'">Importe $</th><th class="customercolortheadth">Dcto %</th><th class="customercolortheadth">Dcto $</th><th class="'+background_tables+'">Importe Descuento $</th><th class="'+background_tables+'">SubTotal $</th><th class="customercolortheadth">Iva %</th><th class="'+background_tables+'">Traslado Iva $</th><th class="'+background_tables+'">Total $</th><th class="'+background_tables+'">Costo $</th><th class="'+background_tables+'">Costo Total $</th><th class="customercolortheadth">Comisión %</th><th class="'+background_tables+'">Comisión $</th><th class="bg-amber">Utilidad $</th><th class="'+background_tables+'">Remisión</th><th class="'+background_tables+'">Carta Porte</th><th class="'+background_tables+'">Orden</th><th class="'+background_tables+'">Departamento</th><th class="'+background_tables+'">Cargo</th><th class="'+background_tables+'">Partida</th><th class="customercolortheadth">Tienda</th><th class="customercolortheadth">Pedido</th><th class="'+background_tables+'">Almacén</th><th class="customercolortheadth">Datos de Unidad</th><th class="'+background_tables+'" hidden>Utilidad Aritmetica %</th><th class="'+background_tables+'" hidden>Utilidad Financiera %</th><th class="'+background_tables+'">Moneda</th><th class="'+background_tables+'">Costo de Lista</th><th class="'+background_tables+'">Tipo De Cambio</th><th class="customercolortheadth">ClaveProducto</th><th class="'+background_tables+'">Nombre ClaveProducto</th><th class="customercolortheadth">ClaveUnidad</th><th class="'+background_tables+'">Nombre ClaveUnidad</th><th class="'+background_tables+'" hidden>Traslado Ieps</th><th class="'+background_tables+'" hidden>Traslado Iva</th><th class="'+background_tables+'" hidden>Retención Iva</th><th class="'+background_tables+'" hidden>Retención Isr</th><th class="'+background_tables+'" hidden>Retención Ieps</th><th class="'+background_tables+'" hidden>Meses</th><th class="'+background_tables+'" hidden>Tasa Interes</th><th class="'+background_tables+'" hidden>Monto Interes</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="row"><div class="col-md-6"><label>Observaciones</label><textarea class="form-control" name="observaciones" id="observaciones" rows="5" onkeyup="tipoLetra(this);" required data-parsley-length="[1, 255]"></textarea></div><div class="col-md-3"><table class="table table-striped table-hover"><tr><td class="tdmod">Crédito</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="credito" id="credito" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Saldo</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="saldo" id="saldo" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Utilidad</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="utilidad" id="utilidad" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Costo</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="costo" id="costo" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr hidden><td class="tdmod">Comisión</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="comision" id="comision" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr></table></div><div class="col-md-3"><table class="table table-striped table-hover"><tr><td class="tdmod">Importe</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="importe" id="importe" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Descuento</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="descuento" id="descuento" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">SubTotal</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="subtotal" id="subtotal" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Iva</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="iva" id="iva" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Total</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="total" id="total" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr></table></div></div><div class="row"><div class="col-md-12"><h5 id="mensajecalculoscompra"></h5></div></div></div></div>';$("#tabsform").html(a),obtenultimonumero(),obtenertiposordenescompra(),obtenertiposunidades(),asignarfechaactual(),comprobartiposerie($("#depto").val()),$("#tipooperacion").val("alta"),$("#divbuscarcodigoproducto").show(),$("#moneda").select2(),$("#tipo").select2(),$("#tipounidad").select2(),contadorfilas=contadorproductos=0,partida=1,$("#numerofilas").val("0"),$("#codigoabuscar").keypress(function(a){13==(a.keyCode||a.which)&&listarproductos()}),$("#numerocliente").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerclientepornumero()}),$("#numerocliente").on("change",function(a){regresarnumerocliente()}),$("#numeroagente").on("keypress",function(a){13==(a.keyCode||a.which)&&obteneragentepornumero()}),$("#numeroagente").on("change",function(a){regresarnumeroagente()}),$("#lugarexpedicion").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerlugarexpedicionporclave()}),$("#lugarexpedicion").on("change",function(a){regresarclavelugarexpedicion()}),$("#claveregimenfiscal").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerregimenfiscalporclave()}),$("#claveregimenfiscal").on("change",function(a){regresarclaveregimenfiscal()}),$("#clavetiporelacion").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenertiporelacionporclave()}),$("#clavetiporelacion").on("change",function(a){regresarclavetiporelacion()}),$("#claveformapago").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerformapagoporclave()}),$("#claveformapago").on("change",function(a){regresarclaveformapago()}),$("#clavemetodopago").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenermetodopagoporclave()}),$("#clavemetodopago").on("change",function(a){regresarclavemetodopago()}),$("#claveusocfdi").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerusocfdiporclave()}),$("#claveusocfdi").on("change",function(a){regresarclaveusocfdi()}),$("#claveresidenciafiscal").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerresidenciafiscalporclave()}),$("#claveresidenciafiscal").on("change",function(a){regresarclaveresidenciafiscal()}),$("#ModalAlta").modal("show")}function cambiodexml(a){var e=$("#tipooperacion").val(),o=$("#xml")[0].files[0],t=new FormData;t.append("xml",o),t.append("tipooperacion",e),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_cargar_xml_uuid_relacionado,data:t,type:"POST",contentType:!1,processData:!1,success:function(a){0==evaluaruuidexistente(a.uuid[0])&&($("#tablauuidrelacionados tbody").append(a.uuidrelacionado),renumerarfilasuuid(),comprobarfilasuuid())},error:function(a){console.log(a)}})}function comprobarfilasuuid(){var a=$("#tablauuidrelacionados tbody tr").length;$("#numerofilasuuid").val(a)}function eliminarfilauuid(a){1==confirm("Esta seguro de eliminar la fila?")&&($("#filauuid"+a).remove(),renumerarfilasuuid(),comprobarfilasuuid())}function renumerarfilasuuid(){for(var a=document.getElementsByClassName("filasuuid"),e=0;e<a.length;e++)a[e].setAttribute("id","filauuid"+e);a=document.getElementsByClassName("btneliminaruuid");for(e=0;e<a.length;e++)a[e].setAttribute("onclick","eliminarfilauuid("+e+")")}function evaluaruuidexistente(e){var o=0,t=0,l=0;return $("tr.filasuuid").each(function(){var a=$(".uuidrelacionado",this).val();e===a?o++:t++,l++}),parseInt(t)-parseInt(o)!=l}function calculartotalesfilas(b){var v=0;$("tr.filasproductos").each(function(){var a,e,o,t,l,r,i,s,d,n,c,m,u,p;b===v&&(a=$(".cantidadpartida",this).val(),e=$(".preciopartida",this).val(),n=$(".importepartida",this).val(),o=$(".descuentopesospartida",this).val(),t=$(".importedescuentopesospartida",this).val(),l=$(".subtotalpartida",this).val(),c=$(".ivaporcentajepartida",this).val(),m=$(".trasladoivapesospartida",this).val(),r=$(".totalpesospartida",this).val(),i=$(".utilidadpartida",this).val(),s=$(".costopartida",this).val(),d=$(".costototalpartida ",this).val(),u=$(".comisionporcentajepartida ",this).val(),p=$(".comisionespesospartida ",this).val(),n=new Decimal(a).times(e),$(".importepartida",this).val(number_format(round(n,numerodecimales),numerodecimales,".","")),t=new Decimal(n).minus(o),$(".importedescuentopesospartida",this).val(number_format(round(t,numerodecimales),numerodecimales,".","")),l=new Decimal(n).minus(o),$(".subtotalpartida",this).val(number_format(round(l,numerodecimales),numerodecimales,".","")),c=new Decimal(l).times(c),m=new Decimal(c/100),$(".trasladoivapesospartida",this).val(number_format(round(m,numerodecimales),numerodecimales,".","")),r=new Decimal(l).plus(m),$(".totalpesospartida",this).val(number_format(round(r,numerodecimales),numerodecimales,".","")),d=new Decimal(s).times(a),$(".costototalpartida",this).val(number_format(round(d,numerodecimales),numerodecimales,".","")),u=new Decimal(l).times(u),p=new Decimal(u/100),$(".comisionespesospartida",this).val(number_format(round(p,numerodecimales),numerodecimales,".","")),i=new Decimal(l).minus(d).minus(p),$(".utilidadpartida",this).val(number_format(round(i,numerodecimales),numerodecimales,".","")),calculartotal()),v++})}function cambiodecantidadopreciopartida(a){var e=0;$("tr.filasproductos").each(function(){a===e&&(calculardescuentoporcentajepartida(a),calculartotalesfilas(a),calculartotal()),e++})}function calculardescuentoporcentajepartida(o){var t=0;$("tr.filasproductos").each(function(){var a,e;o===t&&(e=$(".importepartida",this).val(),a=$(".descuentopesospartida",this).val(),a=new Decimal(a).times(100),e=new Decimal(a/e),$(".descuentoporcentajepartida",this).val(number_format(round(e,numerodecimales),numerodecimales,".","")),calculartotalesfilas(o)),t++})}function calculardescuentopesospartida(o){var t=0;$("tr.filasproductos").each(function(){var a,e;o===t&&(a=$(".importepartida",this).val(),e=$(".descuentoporcentajepartida",this).val(),e=new Decimal(a).times(e),e=new Decimal(e/100),$(".descuentopesospartida",this).val(number_format(round(e,numerodecimales),numerodecimales,".","")),calculartotalesfilas(o)),t++})}function calculartotal(){var a=0,e=0,o=0,t=0,l=0,r=0,i=0,s=0;$("tr.filasproductos").each(function(){a=new Decimal(a).plus($(".importepartida",this).val()),e=new Decimal(e).plus($(".descuentopesospartida",this).val()),o=new Decimal(o).plus($(".subtotalpartida",this).val()),t=new Decimal(t).plus($(".trasladoivapesospartida",this).val()),l=new Decimal(l).plus($(".totalpesospartida",this).val()),r=new Decimal(r).plus($(".utilidadpartida",this).val()),i=new Decimal(i).plus($(".costototalpartida",this).val()),s=new Decimal(s).plus($(".comisionpesospartida",this).val())}),$("#importe").val(number_format(round(a,numerodecimales),numerodecimales,".","")),$("#descuento").val(number_format(round(e,numerodecimales),numerodecimales,".","")),$("#subtotal").val(number_format(round(o,numerodecimales),numerodecimales,".","")),$("#iva").val(number_format(round(t,numerodecimales),numerodecimales,".","")),$("#total").val(number_format(round(l,numerodecimales),numerodecimales,".","")),$("#totalafacturar").val(number_format(round(l,numerodecimales),numerodecimales,".","")),$("#utilidad").val(number_format(round(r,numerodecimales),numerodecimales,".","")),$("#costo").val(number_format(round(i,numerodecimales),numerodecimales,".","")),$("#comision").val(number_format(round(s,numerodecimales),numerodecimales,".",""))}function eliminarfila(e){return new Promise(a=>{setTimeout(function(){return $("#filaproducto"+e).remove(),contadorfilas--,partida--,a(e)},1500)})}function comprobarfilas(){var a=$("#tabladetallesfactura tbody tr").length;$("#numerofilas").val(a)}function renumerarfilas(){for(var a=document.getElementsByClassName("numeropartida"),e=0;e<a.length;e++)a[e].innerHTML=parseInt(e)+1;a=document.getElementsByClassName("filasproductos");for(e=0;e<a.length;e++)a[e].setAttribute("id","filaproducto"+e);a=document.getElementsByClassName("cantidadpartida");for(e=0;e<a.length;e++)a[e].setAttribute("onchange","formatocorrectoinputcantidades(this);calculartotalesfilas("+e+");cambiodecantidadopreciopartida("+e+",'"+tipo+"')");a=document.getElementsByClassName("preciopartida");for(e=0;e<a.length;e++)a[e].setAttribute("onchange","formatocorrectoinputcantidades(this);calculartotalesfilas("+e+");cambiodecantidadopreciopartida("+e+",'"+tipo+"')");a=document.getElementsByClassName("descuentoporcentajepartida");for(e=0;e<a.length;e++)a[e].setAttribute("onchange","formatocorrectoinputcantidades(this);calculardescuentopesospartida("+e+")");a=document.getElementsByClassName("descuentopesospartida");for(e=0;e<a.length;e++)a[e].setAttribute("onchange","formatocorrectoinputcantidades(this);calculardescuentoporcentajepartida("+e+")");a=document.getElementsByClassName("ivaporcentajepartida");for(e=0;e<a.length;e++)a[e].setAttribute("onchange","formatocorrectoinputcantidades(this);calculartotalesfilas("+e+")");a=document.getElementsByClassName("comisionporcentajepartida");for(e=0;e<a.length;e++)a[e].setAttribute("onchange","formatocorrectoinputcantidades(this);calculardescuentopesospartida("+e+")");a=document.getElementsByClassName("btnlistarclavesproductos");for(e=0;e<a.length;e++)a[e].setAttribute("onclick","listarclavesproductos("+e+")");a=document.getElementsByClassName("btnlistarclavesunidades");for(e=0;e<a.length;e++)a[e].setAttribute("onclick","listarclavesunidades("+e+")")}function obtenerdatos(o){$("#titulomodal").html("Modificación Factura"),$(".page-loader-wrapper").css("display","block"),$.get(facturas_obtener_factura,{facturamodificar:o},function(a){var e='<div class="row"><div class="col-md-12"><ul class="nav nav-tabs tab-col-blue-grey" role="tablist"><li role="presentation" class="active"><a href="#facturatab" data-toggle="tab">Factura</a></li><li role="presentation"><a href="#emisortab" data-toggle="tab">Emisor</a></li><li role="presentation"><a href="#receptortab" data-toggle="tab">Receptor ó Cliente</a></li><li role="presentation"><a href="#otrostab" data-toggle="tab">Otros</a></li></ul><div class="tab-content"><div role="tabpanel" class="tab-pane fade in active" id="facturatab"><div class="row"><div class="col-md-3"><label>Factura <b style="color:#F44336 !important;" id="serietexto"> Serie: '+serieusuario+'</b>&nbsp;&nbsp; <b style="color:#F44336 !important;" id="esquematexto"> Esquema: '+esquema+'</b>  <div class="btn btn-xs bg-red waves-effect" id="btnobtenerfoliosfacturas" onclick="obtenerfoliosfacturas()">Cambiar</div></label><input type="text" class="form-control" name="folio" id="folio" required readonly onkeyup="tipoLetra(this);"><input type="hidden" class="form-control" name="serie" id="serie" value="'+serieusuario+'" required readonly data-parsley-length="[1, 10]"><input type="hidden" class="form-control" name="stringremisionesseleccionadas" id="stringremisionesseleccionadas" readonly required><input type="hidden" class="form-control" name="stringordenesseleccionadas" id="stringordenesseleccionadas" readonly required><input type="hidden" class="form-control" name="tipooperacion" id="tipooperacion" readonly><input type="hidden" class="form-control" name="numerofilas" id="numerofilas" readonly><input type="hidden" class="form-control" name="esquema" id="esquema" value="'+esquema+'" readonly data-parsley-length="[1, 10]"><input type="hidden" class="form-control" name="depto" id="depto" value="'+depto+'" readonly ><input type="hidden" class="form-control" name="facturabd" id="facturabd" value="'+o+'" readonly data-parsley-length="[1, 20]"></div><div class="col-md-3"><label>Cliente <span class="label label-danger" id="textonombrecliente"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" id="btnobtenerclientes" onclick="obtenerclientes()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="numerocliente" id="numerocliente" required data-parsley-type="integer"><input type="hidden" class="form-control" name="numeroclienteanterior" id="numeroclienteanterior" required data-parsley-type="integer"><input type="hidden" class="form-control" name="cliente" id="cliente" required readonly><input type="hidden" class="form-control" name="rfccliente" id="rfccliente" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Agente <span class="label label-danger" id="textonombreagente"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" id="btnobteneragentes" onclick="obteneragentes()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="numeroagente" id="numeroagente" required data-parsley-type="integer"><input type="hidden" class="form-control" name="numeroagenteanterior" id="numeroagenteanterior"  required data-parsley-type="integer"><input type="hidden" class="form-control" name="rfcagente" id="rfcagente" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="agente" id="agente" required readonly></div></td></tr></table></div><div class="col-md-1"><label>Plazo días</label><input type="text" class="form-control" name="plazo" id="plazo" value="5" required ></div><div class="col-md-2"><label>Fecha</label><input type="datetime-local" class="form-control" name="fecha" id="fecha" required onchange="validasolomesactual();"><input type="hidden" class="form-control" name="periodohoy" id="periodohoy" value="'+periodohoy+'"><input type="hidden" class="form-control" name="meshoy" id="meshoy" value="'+meshoy+'"></div></div><div class="row"><div class="col-md-2"><table class="col-md-12"><tr><td><label>Moneda</label><select name="moneda" id="moneda" class="form-control select2" style="width:100% !important;" required><option value="MXN">MXN</option><option value="USD">USD</option><option value="EUR">EUR</option></select></td><td><label>Pesos</label><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control" name="pesosmoneda" id="pesosmoneda" value="1.'+numerocerosconfigurados+'" required data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" onchange="formatocorrectoinputcantidades(this);"></td></tr></table></div><div class="col-md-2"><label>Pedido</label><input type="text" class="form-control" name="pedido" id="pedido" data-parsley-length="[1, 50]"></div><div class="col-md-2"><label>Tipo</label><select id="tipo" name="tipo" class="form-control select2" style="width:100%"></select></div><div class="col-md-2"><label>Unidad</label><select id="tipounidad" name="tipounidad" class="form-control select2" style="width:100%"></select></div><div class="col-md-4" id="divbuscarcodigos"  style="display:none"><label>Escribe el código a buscar y presiona la tecla ENTER</label><input type="text" class="form-control" name="codigoabuscar" id="codigoabuscar" placeholder="Escribe el código del producto" autocomplete="off"></div><div class="col-md-4" id="divlistarremisiones"  style="display:none"><label>Remisiones</label><div class="btn btn-block bg-blue waves-effect" id="btnlistarremisiones" onclick="listarremisiones()">Agregar Remisiones</div></div><div class="col-md-4" id="divlistarservicios"  style="display:none"><label>Servicios</label><div class="btn btn-block bg-blue waves-effect" id="btnlistarservicios" onclick="listarordenes()">Agregar Servicios</div></div></div></div><div role="tabpanel" class="tab-pane fade" id="emisortab"><div class="row"><div class="col-md-4"><label>R.F.C.</label><input type="text" class="form-control" name="emisorrfc" id="emisorrfc" value="'+rfcempresa+'"  required readonly data-parsley-regexrfc="^[A-Z,0-9]{12,13}$" data-parsley-length="[1, 20]" onkeyup="tipoLetra(this);mayusculas(this);"></div><div class="col-md-4"><label>Emisor Nombre</label><input type="text" class="form-control" name="emisornombre" id="emisornombre" value="'+nombreempresa+'" required readonly data-parsley-length="[1, 150]" onkeyup="tipoLetra(this);"></div><div class="col-md-4"><label>Confirmación</label><input type="text" class="form-control" name="confirmacion" id="confirmacion" onkeyup="tipoLetra(this);" data-parsley-length="[1, 20]"></div></div><div class="row"><div class="col-md-4"><label>Lugar Expedición <span class="label label-danger" id="textonombrelugarexpedicion"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerlugaresexpedicion()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="lugarexpedicion" id="lugarexpedicion" value="'+lugarexpedicion+'" required><input type="hidden" class="form-control" name="lugarexpedicionanterior" id="lugarexpedicionanterior" value="'+lugarexpedicion+'" required></div></td></tr></table></div><div class="col-md-4"><label>Régimen Fiscal <span class="label label-danger" id="textonombreregimenfiscal">'+regimenfiscal+'</span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerregimenesfiscales()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveregimenfiscal" id="claveregimenfiscal" value="'+claveregimenfiscal+'" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveregimenfiscalanterior" id="claveregimenfiscalanterior" value="'+claveregimenfiscal+'" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="regimenfiscal" id="regimenfiscal" value="'+regimenfiscal+'" required readonly></div></td></tr></table></div><div class="col-md-4"><label>Tipo Relación <span class="label label-danger" id="textonombretiporelacion"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenertiposrelaciones()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="clavetiporelacion" id="clavetiporelacion" onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="clavetiporelacionanterior" id="clavetiporelacionanterior"  readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="tiporelacion" id="tiporelacion" readonly></div></td></tr></table></div></div><div class="row"><div class="col-md-6"><div class="row"><div class="col-md-12 table-responsive cabecerafija" style="height: 125px;overflow-y: scroll;padding: 0px 0px;"><input type="hidden" class="form-control" name="numerofilasuuid" id="numerofilasuuid" value="0" readonly><table id="tablauuidrelacionados" class="table table-bordered tablauuidrelacionados"><thead class="'+background_tables+'"><tr><th class="customercolortheadth">Comprobante o UUID Relacionado</th><th class="customercolortheadth"><div class="col-md-12"><label for="xml" class="btn btn-success">Selecciona el UUID relacionado</label><input type="file" class="form-control" name="xml" id="xml" onchange="cambiodexml(this)" style="visibility:hidden;display:none;" onclick="this.value=null;" form="formxml"></div></th></tr></thead><tbody></tbody></table></div></div></div></div></div><div role="tabpanel" class="tab-pane fade" id="receptortab"><div class="row"><div class="col-md-3"><label>R.F.C.</label><input type="text" class="form-control" name="receptorrfc" id="receptorrfc"   required readonly data-parsley-regexrfc="^[A-Z,0-9]{12,13}$" data-parsley-length="[1, 20]" onkeyup="tipoLetra(this);mayusculas(this);"></div><div class="col-md-3"><label>Nombre</label><input type="text" class="form-control" name="receptornombre" id="receptornombre"  required readonly onkeyup="tipoLetra(this);" data-parsley-length="[1, 150]"></div><div class="col-md-3"><label>Forma de Pago <span class="label label-danger" id="textonombreformapago"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerformaspago()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveformapago" id="claveformapago" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveformapagoanterior" id="claveformapagoanterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="formapago" id="formapago" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Método de Pago <span class="label label-danger" id="textonombremetodopago"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenermetodospago()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="clavemetodopago" id="clavemetodopago" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="clavemetodopagoanterior" id="clavemetodopagoanterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="metodopago" id="metodopago" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Condiciones de Pago</label><input type="text" class="form-control" name="condicionesdepago" id="condicionesdepago" value="CREDITO" required data-parsley-length="[1, 50]" onkeyup="tipoLetra(this);"></div><div class="col-md-3"><label>Uso CFDI <span class="label label-danger" id="textonombreusocfdi"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerusoscfdi()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveusocfdi" id="claveusocfdi" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveusocfdianterior" id="claveusocfdianterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="usocfdi" id="usocfdi" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Residencia Fiscal <span class="label label-danger" id="textonombreresidenciafiscal"></span></label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenerresidenciasfiscales()">Seleccionar</div></td><td><div class="form-line"><input type="text" class="form-control" name="claveresidenciafiscal" id="claveresidenciafiscal" required onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="claveresidenciafiscalanterior" id="claveresidenciafiscalanterior" required readonly onkeyup="tipoLetra(this)"><input type="hidden" class="form-control" name="residenciafiscal" id="residenciafiscal" required readonly></div></td></tr></table></div><div class="col-md-3"><label>Num Reg Id Trib</label><input type="text" class="form-control" name="numeroregidtrib" id="numeroregidtrib"  data-parsley-length="[1, 40]" onkeyup="tipoLetra(this);"></div></div></div><div role="tabpanel" class="tab-pane fade" id="otrostab"><div class="row"><div class="col-md-4"><label>Tipo PA</label><table class="col-md-12"><tr><td><div class="btn bg-blue waves-effect" onclick="obtenertipospa()">Seleccionar</div></td><td><div class="form-line"><input type="hidden" class="form-control" name="numerotipopa" id="numerotipopa"  readonly onkeyup="tipoLetra(this)"><input type="text" class="form-control" name="tipopa" id="tipopa"  readonly></div></td></tr></table></div><div class="col-md-4"><label>Refactura</label><input type="text" class="form-control" name="refactura" id="refactura"  readonly data-parsley-length="[1, 20]" onkeyup="tipoLetra(this);"></div><div class="col-md-4"><label>Descripción</label><textarea class="form-control" name="descripcion" id="descripcion" rows="3" data-parsley-length="[1, 255]" onkeyup="tipoLetra(this);"></textarea></div></div></div></div></div></div><div class="row"><div class="col-md-12"><ul class="nav nav-tabs tab-col-blue-grey" role="tablist"><li role="presentation" class="active"><a href="#productostab" data-toggle="tab">Partidas</a></li></ul><div class="tab-content"><div role="tabpanel" class="tab-pane fade in active" id="productostab"><div class="row"><div class="col-md-12 table-responsive cabecerafija" style="height: 200px;overflow-y: scroll;padding: 0px 0px;"><table id="tabladetallesfactura" class="table table-bordered tabladetallesfactura"><thead class="'+background_tables+'"><tr><th class="'+background_tables+'">#</th><th class="customercolortheadth">Código</th><th class="customercolortheadth"><div style="width:200px !important;">Descripción</div></th><th class="customercolortheadth">Uda</th><th class="customercolortheadth">Cantidad</th><th class="customercolortheadth">Precio $</th><th class="'+background_tables+'">Importe $</th><th class="customercolortheadth">Dcto %</th><th class="customercolortheadth">Dcto $</th><th class="'+background_tables+'">Importe Descuento $</th><th class="'+background_tables+'">SubTotal $</th><th class="customercolortheadth">Iva %</th><th class="'+background_tables+'">Traslado Iva $</th><th class="'+background_tables+'">Total $</th><th class="'+background_tables+'">Costo $</th><th class="'+background_tables+'">Costo Total $</th><th class="customercolortheadth">Comisión %</th><th class="'+background_tables+'">Comisión $</th><th class="bg-amber">Utilidad $</th><th class="'+background_tables+'">Remisión</th><th class="'+background_tables+'">Carta Porte</th><th class="'+background_tables+'">Orden</th><th class="'+background_tables+'">Departamento</th><th class="'+background_tables+'">Cargo</th><th class="'+background_tables+'">Partida</th><th class="customercolortheadth">Tienda</th><th class="customercolortheadth">Pedido</th><th class="'+background_tables+'">Almacén</th><th class="customercolortheadth">Datos de Unidad</th><th class="'+background_tables+'" hidden>Utilidad Aritmetica %</th><th class="'+background_tables+'" hidden>Utilidad Financiera %</th><th class="'+background_tables+'">Moneda</th><th class="'+background_tables+'">Costo de Lista</th><th class="'+background_tables+'">Tipo De Cambio</th><th class="customercolortheadth">ClaveProducto</th><th class="'+background_tables+'">Nombre ClaveProducto</th><th class="customercolortheadth">ClaveUnidad</th><th class="'+background_tables+'">Nombre ClaveUnidad</th><th class="'+background_tables+'" hidden>Traslado Ieps</th><th class="'+background_tables+'" hidden>Traslado Iva</th><th class="'+background_tables+'" hidden>Retención Iva</th><th class="'+background_tables+'" hidden>Retención Isr</th><th class="'+background_tables+'" hidden>Retención Ieps</th><th class="'+background_tables+'" hidden>Meses</th><th class="'+background_tables+'" hidden>Tasa Interes</th><th class="'+background_tables+'" hidden>Monto Interes</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="row"><div class="col-md-6"><label>Observaciones</label><textarea class="form-control" name="observaciones" id="observaciones" rows="5" onkeyup="tipoLetra(this);" required data-parsley-length="[1, 255]"></textarea></div><div class="col-md-3"><table class="table table-striped table-hover"><tr><td class="tdmod">Crédito</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="credito" id="credito" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Saldo</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="saldo" id="saldo" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Utilidad</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="utilidad" id="utilidad" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Costo</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="costo" id="costo" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr hidden><td class="tdmod">Comisión</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="comision" id="comision" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr></table></div><div class="col-md-3"><table class="table table-striped table-hover"><tr><td class="tdmod">Importe</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="importe" id="importe" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Descuento</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="descuento" id="descuento" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">SubTotal</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="subtotal" id="subtotal" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Iva</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="iva" id="iva" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr><tr><td class="tdmod">Total</td><td class="tdmod"><input type="number" step="0.'+numerocerosconfiguradosinputnumberstep+'" class="form-control divorinputmodmd" name="total" id="total" value="0.'+numerocerosconfigurados+'" data-parsley-decimalesconfigurados="/^[0-9]+[.]+[0-9]{'+numerodecimales+'}$/" required readonly></td></tr></table></div></div><div class="row"><div class="col-md-12"><h5 id="mensajecalculoscompra"></h5></div></div></div></div>';$("#tabsform").html(e),obtenertiposordenescompra(),obtenertiposunidades(),$("#btnobtenerclientes").hide(),$("#btnobtenerfoliosfacturas").hide(),$("#folio").val(a.factura.Folio),$("#serie").val(a.factura.Serie),$("#serietexto").html("Serie: "+a.factura.Serie),$("#esquematexto").html("Esquema: "+a.factura.Esquema),$("#esquema").val(a.factura.Esquema),$("#stringremisionesseleccionadas").val(a.arrayremisiones),$("#stringordenesseleccionadas").val(a.arrayordenes),$("#numerofilas").val(a.numerodetallesfactura),$("#depto").val(a.factura.Depto),$("#numerofilasuuid").val(a.numerodocumentosfactura),$("#fecha").val(a.fecha),$("#cliente").val(a.cliente.Nombre),null!=a.cliente.Nombre&&$("#textonombrecliente").html(a.cliente.Nombre.substring(0,40)),$("#numerocliente").val(a.cliente.Numero),$("#numeroclienteanterior").val(a.cliente.Numero),$("#rfccliente").val(a.cliente.Rfc),$("#agente").val(a.agente.Nombre),null!=a.agente.Nombre&&$("#textonombreagente").html(a.agente.Nombre.substring(0,40)),$("#numeroagente").val(a.agente.Numero),$("#numeroagenteanterior").val(a.agente.Numero),$("#rfcagente").val(a.agente.Rfc),$("#plazo").val(a.factura.Plazo),$("#moneda").val(a.factura.Moneda).change(),$("#pesosmoneda").val(a.tipocambio),$("#pedido").val(a.factura.Pedido),$("#tipo").val(a.factura.Tipo).change(),$("#tipounidad").val(a.factura.Unidad).change(),$("#observaciones").val(a.factura.Obs),$("#emisorrfc").val(a.factura.EmisorRfc),$("#emisornombre").val(a.factura.EmisorNombre),$("#confirmacion").val(a.factura.Confirmacion),$("#lugarexpedicion").val(a.factura.LugarExpedicion),$("#lugarexpedicionanterior").val(a.factura.LugarExpedicion),null!=a.regimenfiscal&&($("#regimenfiscal").val(a.regimenfiscal.Nombre),$("#textonombreregimenfiscal").html(a.regimenfiscal.Nombre.substring(0,40)),$("#claveregimenfiscal").val(a.regimenfiscal.Clave),$("#claveregimenfiscalanterior").val(a.regimenfiscal.Clave)),$("#tiporelacion").val(a.nombretiporelacion),null!=a.nombretiporelacion&&$("#textonombretiporelacion").html(a.nombretiporelacion.substring(0,40)),$("#clavetiporelacion").val(a.clavetiporelacion),$("#clavetiporelacionanterior").val(a.clavetiporelacion),$("#receptorrfc").val(a.factura.ReceptorRfc),$("#receptornombre").val(a.factura.ReceptorNombre),null!=a.formapago&&($("#formapago").val(a.formapago.Nombre),$("#textonombreformapago").html(a.formapago.Nombre.substring(0,40)),$("#claveformapago").val(a.formapago.Clave),$("#claveformapagoanterior").val(a.formapago.Clave)),null!=a.metodopago&&($("#metodopago").val(a.metodopago.Nombre),$("#textonombremetodopago").html(a.metodopago.Nombre.substring(0,40)),$("#clavemetodopago").val(a.metodopago.Clave),$("#clavemetodopagoanterior").val(a.metodopago.Clave)),$("#condicionesdepago").val(a.factura.CondicionesDePago),null!=a.usocfdi&&($("#usocfdi").val(a.usocfdi.Nombre),$("#textonombreusocfdi").html(a.usocfdi.Nombre.substring(0,40)),$("#claveusocfdi").val(a.usocfdi.Clave),$("#claveusocfdianterior").val(a.usocfdi.Clave)),null!=a.residenciafiscal&&($("#residenciafiscal").val(a.residenciafiscal.Nombre),$("#textonombreresidenciafiscal").html(a.residenciafiscal.Nombre.substring(0,40)),$("#claveresidenciafiscal").val(a.residenciafiscal.Clave),$("#claveresidenciafiscalanterior").val(a.residenciafiscal.Clave)),$("#numeroregidtrib").val(a.factura.NumRegIdTrib),$("#descripcion").val(a.factura.Descripcion),$("#tabladetallesfactura tbody").html(a.filasdetallesfactura),$("#importe").val(a.importe),$("#descuento").val(a.descuento),$("#subtotal").val(a.subtotal),$("#iva").val(a.iva),$("#total").val(a.total),$("#tablauuidrelacionados tbody").html(a.filasdocumentosfactura),$("#credito").val(a.credito),$("#saldo").val(a.saldo),$("#utilidad").val(a.utilidad),$("#costo").val(a.costo),$("#tipooperacion").val("modificacion"),$("#moneda").select2(),$("#tipo").select2(),$("#tipounidad").select2(),contadorproductos=a.contadorproductos,contadorfilas=a.contadorfilas,partida=a.partida,$("#codigoabuscar").keypress(function(a){13==(a.keyCode||a.which)&&listarproductos()}),$("#numerocliente").on("change",function(a){regresarnumerocliente()}),$("#numeroagente").on("keypress",function(a){13==(a.keyCode||a.which)&&obteneragentepornumero()}),$("#numeroagente").on("change",function(a){regresarnumeroagente()}),$("#lugarexpedicion").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerlugarexpedicionporclave()}),$("#lugarexpedicion").on("change",function(a){regresarclavelugarexpedicion()}),$("#claveregimenfiscal").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerregimenfiscalporclave()}),$("#claveregimenfiscal").on("change",function(a){regresarclaveregimenfiscal()}),$("#clavetiporelacion").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenertiporelacionporclave()}),$("#clavetiporelacion").on("change",function(a){regresarclavetiporelacion()}),$("#claveformapago").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerformapagoporclave()}),$("#claveformapago").on("change",function(a){regresarclaveformapago()}),$("#clavemetodopago").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenermetodopagoporclave()}),$("#clavemetodopago").on("change",function(a){regresarclavemetodopago()}),$("#claveusocfdi").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerusocfdiporclave()}),$("#claveusocfdi").on("change",function(a){regresarclaveusocfdi()}),$("#claveresidenciafiscal").on("keypress",function(a){13==(a.keyCode||a.which)&&obtenerresidenciafiscalporclave()}),$("#claveresidenciafiscal").on("change",function(a){regresarclaveresidenciafiscal()}),renumerarfilasuuid(),mostrarmodalformulario("MODIFICACION",a.modificacionpermitida),$(".page-loader-wrapper").css("display","none")}).fail(function(){msj_errorajax(),$(".page-loader-wrapper").css("display","none")})}function desactivar(e){$.get(facturas_verificar_si_continua_baja,{facturadesactivar:e},function(a){"BAJA"==a.Status?($("#facturadesactivar").val(0),$("#textomodaldesactivar").html("Error, esta Factura ya fue dado de baja"),$("#divmotivobaja").hide(),$("#btnbaja").hide()):""!=a.resultadofechas?($("#facturadesactivar").val(0),$("#textomodaldesactivar").html("Error solo se pueden dar de baja las facturas del mes actual, fecha de la factura: "+a.resultadofechas),$("#divmotivobaja").hide(),$("#btnbaja").hide()):0<a.numerocuentasporcobrar?($("#facturadesactivar").val(0),$("#textomodaldesactivar").html("Error esta factura tiene registros de cuentas por cobrar con el pago: "+a.numerocuentaxcobrar),$("#divmotivobaja").hide(),$("#btnbaja").hide()):0<a.numeronotascliente?($("#facturadesactivar").val(0),$("#textomodaldesactivar").html("Error esta factura tiene registros de notas crédito cliente con la nota: "+a.numeronotacliente),$("#divmotivobaja").hide(),$("#btnbaja").hide()):($("#facturadesactivar").val(e),$("#textomodaldesactivar").html("Estas seguro de dar de baja la factura? No"+e),$("#divmotivobaja").show(),$("#btnbaja").show()),$("#estatusregistro").modal("show")})}function enviardocumentoemail(e){$.get(facturas_obtener_datos_envio_email,{documento:e},function(a){$("#textomodalenviarpdfemail").html("Enviar email Factura No."+e),$("#emaildocumento").val(e),$("#emailde").val(a.emailde),$("#emailpara").val(a.emailpara),$("#emailasunto").val("FACTURA NO. "+e+" DE USADOS TRACTOCAMIONES Y PARTES REFACCIONARIAS SA DE CV"),""!=a.factura.UUID?$("#incluir_xml").removeAttr("onclick"):$("#incluir_xml").attr("onclick","javascript: return false;"),$("#divincluirxml").show(),$("#modalenviarpdfemail").modal("show")})}function timbrarfactura(e){$.get(facturas_verificar_si_continua_timbrado,{factura:e},function(a){"BAJA"==a.Status?($("#facturatimbrado").val(0),$("#textomodaltimbrado").html("Error, esta Factura se encuentra dada de baja"),$("#modaltimbrado").modal("show"),$("#btntimbrarfactura").hide()):""!=a.UUID?($("#facturatimbrado").val(0),$("#textomodaltimbrado").html("Error, esta Factura ya se timbro"),$("#modaltimbrado").modal("show"),$("#btntimbrarfactura").hide()):($("#modaltimbrado").modal("show"),$("#textomodaltimbrado").html("Esta seguro de timbrar la factura? No"+e),$("#facturatimbrado").val(e),$("#btntimbrarfactura").show())})}function cancelartimbre(e){$.get(facturas_verificar_si_continua_baja_timbre,{facturabajatimbre:e},function(a){""!=a.obtener_factura?"none"==a.obtener_factura.cancellation_status||"pending"==a.obtener_factura.cancellation_status?($("#facturabajatimbre").val(e),$("#iddocumentofacturapi").val(a.obtener_factura.id),$("#textomodalbajatimbre").html("Esta seguro de dar de baja el timbre de la factura No."+e),$("#btnbajatimbre").show(),$("#modalbajatimbre").modal("show")):"accepted"==a.obtener_factura.cancellation_status&&($("#facturabajatimbre").val(0),$("#iddocumentofacturapi").val(0),$("#textomodalbajatimbre").html("Aviso el timbre de la factura No."+e+" ya esta cancelado"),$("#btnbajatimbre").hide(),$("#modalbajatimbre").modal("show")):($("#facturabajatimbre").val(0),$("#iddocumentofacturapi").val(0),$("#textomodalbajatimbre").html("Aviso la factura No."+e+" no esta timbrada"),$("#btnbajatimbre").hide(),$("#modalbajatimbre").modal("show"))})}function relistarbuscarstringlike(){$("#tablafoliosencontrados").DataTable().ajax.reload()}function buscarstringlike(){$("#columnastablafoliosencontrados").html('<tr><th><div style="width:80px !important;">Generar Documento en PDF</div></th><th>Factura</th><th>Cliente</th><th>Total</th><th>Status</th></tr>'),tabla=$("#tablafoliosencontrados").DataTable({paging:!1,ordering:!1,info:!1,searching:!1,processing:!0,serverSide:!0,ajax:{url:facturas_buscar_folio_string_like,data:function(a){a.string=$("#buscarfolio").val()}},columns:[{data:"operaciones",name:"operaciones",orderable:!1,searchable:!1},{data:"Factura",name:"Factura"},{data:"Cliente",name:"Cliente",orderable:!1,searchable:!1},{data:"Total",name:"Total",orderable:!1,searchable:!1},{data:"Status",name:"Status",orderable:!1,searchable:!1}]})}function configurar_tabla(){$("#tabsconfigurartabla").html('<ul class="nav nav-tabs tab-col-blue-grey" role="tablist"><li role="presentation" class="active"><a href="#tabcamposamostrar" data-toggle="tab">Campos a mostrar</a></li><li role="presentation"><a href="#tabordenarcolumnas" data-toggle="tab">Ordenar Columnas</a></li></ul><div class="tab-content"><div role="tabpanel" class="tab-pane fade in active" id="tabcamposamostrar"><div class="row"><div class="col-md-6"><div class="col-md-12 form-check"><label>DATOS FACTURA</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Factura" id="idFactura" class="filled-in datotabla" value="Factura" readonly onchange="construirarraydatostabla(this);" onclick="javascript: return false;"/><label for="idFactura">Factura</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Serie" id="idSerie" class="filled-in datotabla" value="Serie" onchange="construirarraydatostabla(this);" /><label for="idSerie">Serie</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Folio" id="idFolio" class="filled-in datotabla" value="Folio" onchange="construirarraydatostabla(this);" /><label for="idFolio">Folio</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Fecha" id="idFecha" class="filled-in datotabla" value="Fecha" onchange="construirarraydatostabla(this);" /><label for="idFecha">Fecha</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Status" id="idStatus" class="filled-in datotabla" value="Status" readonly onchange="construirarraydatostabla(this);" onclick="javascript: return false;"/><label for="idStatus">Status</label></div><div class="col-md-4 form-check"><input type="checkbox" name="UUID" id="idUUID" class="filled-in datotabla" value="UUID" onchange="construirarraydatostabla(this);" /><label for="idUUID">UUID</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Esquema" id="idEsquema" class="filled-in datotabla" value="Esquema" onchange="construirarraydatostabla(this);" /><label for="idEsquema">Esquema</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Depto" id="idDepto" class="filled-in datotabla" value="Depto" onchange="construirarraydatostabla(this);" /><label for="idDepto">Depto</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Cliente" id="idCliente" class="filled-in datotabla" value="Cliente" onchange="construirarraydatostabla(this);" /><label for="idCliente">Cliente</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Remision" id="idRemision" class="filled-in datotabla" value="Remision" onchange="construirarraydatostabla(this);" /><label for="idRemision">Remision</label></div><div class="col-md-4 form-check"><input type="checkbox" name="OrdenTrabajo" id="idOrdenTrabajo" class="filled-in datotabla" value="OrdenTrabajo" onchange="construirarraydatostabla(this);" /><label for="idOrdenTrabajo">OrdenTrabajo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="EconomicoOrdenTrabajo" id="idEconomicoOrdenTrabajo" class="filled-in datotabla" value="EconomicoOrdenTrabajo" onchange="construirarraydatostabla(this);" /><label for="idEconomicoOrdenTrabajo">EconomicoOrdenTrabajo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Pedido" id="idPedido" class="filled-in datotabla" value="Pedido" onchange="construirarraydatostabla(this);" /><label for="idPedido">Pedido</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Agente" id="idAgente" class="filled-in datotabla" value="Agente" onchange="construirarraydatostabla(this);" /><label for="idAgente">Agente</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Tipo" id="idTipo" class="filled-in datotabla" value="Tipo" onchange="construirarraydatostabla(this);" /><label for="idTipo">Tipo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Plazo" id="idPlazo" class="filled-in datotabla" value="Plazo" onchange="construirarraydatostabla(this);" /><label for="idPlazo">Plazo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="SubTotal" id="idSubTotal" class="filled-in datotabla" value="SubTotal" onchange="construirarraydatostabla(this);" /><label for="idSubTotal">SubTotal</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Iva" id="idIva" class="filled-in datotabla" value="Iva" onchange="construirarraydatostabla(this);" /><label for="idIva">Iva</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Total" id="idTotal" class="filled-in datotabla" value="Total" onchange="construirarraydatostabla(this);" /><label for="idTotal">Total</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Abonos" id="idAbonos" class="filled-in datotabla" value="Abonos" onchange="construirarraydatostabla(this);" /><label for="idAbonos">Abonos</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Descuentos" id="idDescuentos" class="filled-in datotabla" value="Descuentos" onchange="construirarraydatostabla(this);" /><label for="idDescuentos">Descuentos</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Saldo" id="idSaldo" class="filled-in datotabla" value="Saldo" onchange="construirarraydatostabla(this);" /><label for="idSaldo">Saldo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Equipo" id="idEquipo" class="filled-in datotabla" value="Equipo" onchange="construirarraydatostabla(this);" /><label for="idEquipo">Equipo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Usuario" id="idUsuario" class="filled-in datotabla" value="Usuario" onchange="construirarraydatostabla(this);" /><label for="idUsuario">Usuario</label></div><div class="col-md-4 form-check"><input type="checkbox" name="MotivoBaja" id="idMotivoBaja" class="filled-in datotabla" value="MotivoBaja" onchange="construirarraydatostabla(this);" /><label for="idMotivoBaja">MotivoBaja</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Periodo" id="idPeriodo" class="filled-in datotabla" value="Periodo" onchange="construirarraydatostabla(this);" /><label for="idPeriodo">Periodo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Orden" id="idOrden" class="filled-in datotabla" value="Orden" onchange="construirarraydatostabla(this);" /><label for="idOrden">Orden</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Unidad" id="idUnidad" class="filled-in datotabla" value="Unidad" onchange="construirarraydatostabla(this);" /><label for="idUnidad">Unidad</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Lpa" id="idLpa" class="filled-in datotabla" value="Lpa" onchange="construirarraydatostabla(this);" /><label for="idLpa">Lpa</label></div><div class="col-md-4 form-check"><input type="checkbox" name="BloquearObsoleto" id="idBloquearObsoleto" class="filled-in datotabla" value="BloquearObsoleto" onchange="construirarraydatostabla(this);" /><label for="idBloquearObsoleto">BloquearObsoleto</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Incobrable" id="idIncobrable" class="filled-in datotabla" value="Incobrable" onchange="construirarraydatostabla(this);" /><label for="idIncobrable">Incobrable</label></div><div class="col-md-4 form-check"><input type="checkbox" name="TipoPA" id="idTipoPA" class="filled-in datotabla" value="TipoPA" onchange="construirarraydatostabla(this);" /><label for="idTipoPA">TipoPA</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Refactura" id="idRefactura" class="filled-in datotabla" value="Refactura" onchange="construirarraydatostabla(this);" /><label for="idRefactura">Refactura</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Importe" id="idImporte" class="filled-in datotabla" value="Importe" onchange="construirarraydatostabla(this);" /><label for="idImporte">Importe</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Descuento" id="idDescuento" class="filled-in datotabla" value="Descuento" onchange="construirarraydatostabla(this);" /><label for="idDescuento">Descuento</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Ieps" id="idIeps" class="filled-in datotabla" value="Ieps" onchange="construirarraydatostabla(this);" /><label for="idIeps">Ieps</label></div><div class="col-md-4 form-check"><input type="checkbox" name="IvaRetencion" id="idIvaRetencion" class="filled-in datotabla" value="IvaRetencion" onchange="construirarraydatostabla(this);" /><label for="idIvaRetencion">IvaRetencion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="IsrRetencion" id="idIsrRetencion" class="filled-in datotabla" value="IsrRetencion" onchange="construirarraydatostabla(this);" /><label for="idIsrRetencion">IsrRetencion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="IepsRetencion" id="idIepsRetencion" class="filled-in datotabla" value="IepsRetencion" onchange="construirarraydatostabla(this);" /><label for="idIepsRetencion">IepsRetencion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="ImpLocRetenciones" id="idImpLocRetenciones" class="filled-in datotabla" value="ImpLocRetenciones" onchange="construirarraydatostabla(this);" /><label for="idImpLocRetenciones">ImpLocRetenciones</label></div><div class="col-md-4 form-check"><input type="checkbox" name="ImpLocTraslados" id="idImpLocTraslados" class="filled-in datotabla" value="ImpLocTraslados" onchange="construirarraydatostabla(this);" /><label for="idImpLocTraslados">ImpLocTraslados</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Costo" id="idCosto" class="filled-in datotabla" value="Costo" onchange="construirarraydatostabla(this);" /><label for="idCosto">Costo</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Comision" id="idComision" class="filled-in datotabla" value="Comision" onchange="construirarraydatostabla(this);" /><label for="idComision">Comision</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Utilidad" id="idUtilidad" class="filled-in datotabla" value="Utilidad" onchange="construirarraydatostabla(this);" /><label for="idUtilidad">Utilidad</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Moneda" id="idMoneda" class="filled-in datotabla" value="Moneda" onchange="construirarraydatostabla(this);" /><label for="idMoneda">Moneda</label></div><div class="col-md-4 form-check"><input type="checkbox" name="TipoCambio" id="idTipoCambio" class="filled-in datotabla" value="TipoCambio" onchange="construirarraydatostabla(this);" /><label for="idTipoCambio">TipoCambio</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Descripcion" id="idDescripcion" class="filled-in datotabla" value="Descripcion" onchange="construirarraydatostabla(this);" /><label for="idDescripcion">Descripcion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Obs" id="idObs" class="filled-in datotabla" value="Obs" onchange="construirarraydatostabla(this);" /><label for="idObs">Obs</label></div><div class="col-md-4 form-check"><input type="checkbox" name="CondicionesDePago" id="idCondicionesDePago" class="filled-in datotabla" value="CondicionesDePago" onchange="construirarraydatostabla(this);" /><label for="idCondicionesDePago">CondicionesDePago</label></div><div class="col-md-4 form-check"><input type="checkbox" name="LugarExpedicion" id="idLugarExpedicion" class="filled-in datotabla" value="LugarExpedicion" onchange="construirarraydatostabla(this);" /><label for="idLugarExpedicion">LugarExpedicion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="RegimenFiscal" id="idRegimenFiscal" class="filled-in datotabla" value="RegimenFiscal" onchange="construirarraydatostabla(this);" /><label for="idRegimenFiscal">RegimenFiscal</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Confirmacion" id="idConfirmacion" class="filled-in datotabla" value="Confirmacion" onchange="construirarraydatostabla(this);" /><label for="idConfirmacion">Confirmacion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="FormaPago" id="idFormaPago" class="filled-in datotabla" value="FormaPago" onchange="construirarraydatostabla(this);" /><label for="idFormaPago">FormaPago</label></div><div class="col-md-4 form-check"><input type="checkbox" name="MetodoPago" id="idMetodoPago" class="filled-in datotabla" value="MetodoPago" onchange="construirarraydatostabla(this);" /><label for="idMetodoPago">MetodoPago</label></div><div class="col-md-4 form-check"><input type="checkbox" name="UsoCfdi" id="idUsoCfdi" class="filled-in datotabla" value="UsoCfdi" onchange="construirarraydatostabla(this);" /><label for="idUsoCfdi">UsoCfdi</label></div><div class="col-md-4 form-check"><input type="checkbox" name="ResidenciaFiscal" id="idResidenciaFiscal" class="filled-in datotabla" value="ResidenciaFiscal" onchange="construirarraydatostabla(this);" /><label for="idResidenciaFiscal">ResidenciaFiscal</label></div><div class="col-md-4 form-check"><input type="checkbox" name="TipoRelacion" id="idTipoRelacion" class="filled-in datotabla" value="TipoRelacion" onchange="construirarraydatostabla(this);" /><label for="idTipoRelacion">TipoRelacion</label></div><div class="col-md-4 form-check"><input type="checkbox" name="NumRegIdTrib" id="idNumRegIdTrib" class="filled-in datotabla" value="NumRegIdTrib" onchange="construirarraydatostabla(this);" /><label for="idNumRegIdTrib">NumRegIdTrib</label></div><div class="col-md-4 form-check"><input type="checkbox" name="EmisorRfc" id="idEmisorRfc" class="filled-in datotabla" value="EmisorRfc" onchange="construirarraydatostabla(this);" /><label for="idEmisorRfc">EmisorRfc</label></div><div class="col-md-4 form-check"><input type="checkbox" name="EmisorNombre" id="idEmisorNombre" class="filled-in datotabla" value="EmisorNombre" onchange="construirarraydatostabla(this);" /><label for="idEmisorNombre">EmisorNombre</label></div><div class="col-md-4 form-check"><input type="checkbox" name="ReceptorRfc" id="idReceptorRfc" class="filled-in datotabla" value="ReceptorRfc" onchange="construirarraydatostabla(this);" /><label for="idReceptorRfc">ReceptorRfc</label></div><div class="col-md-4 form-check"><input type="checkbox" name="ReceptorNombre" id="idReceptorNombre" class="filled-in datotabla" value="ReceptorNombre" onchange="construirarraydatostabla(this);" /><label for="idReceptorNombre">ReceptorNombre</label></div><div class="col-md-4 form-check"><input type="checkbox" name="FechaTimbrado" id="idFechaTimbrado" class="filled-in datotabla" value="FechaTimbrado" onchange="construirarraydatostabla(this);" /><label for="idFechaTimbrado">FechaTimbrado</label></div><div class="col-md-4 form-check"><input type="checkbox" name="Hora" id="idHora" class="filled-in datotabla" value="Hora" onchange="construirarraydatostabla(this);" /><label for="idHora">Hora</label></div><input type="hidden" class="form-control" name="string_datos_tabla_true" id="string_datos_tabla_true" required><input type="hidden" class="form-control" name="string_datos_tabla_false" id="string_datos_tabla_false" required></div><div class="col-md-6"><div class="col-md-12 form-check"><label>DATOS CLIENTE</label></div><div class="col-md-4 form-check"><input type="checkbox" name="NombreCliente" id="idNombreCliente" class="filled-in datotabla" value="NombreCliente"  onchange="construirarraydatostabla(this);"/><label for="idNombreCliente">NombreCliente</label></div><div class="col-md-4 form-check"><input type="checkbox" name="RfcCliente" id="idRfcCliente" class="filled-in datotabla" value="RfcCliente"  onchange="construirarraydatostabla(this);"/><label for="idRfcCliente">RfcCliente</label></div><div class="col-md-12 form-check"><label>DATOS AGENTE</label></div><div class="col-md-4 form-check"><input type="checkbox" name="NombreAgente" id="idNombreAgente" class="filled-in datotabla" value="NombreAgente"  onchange="construirarraydatostabla(this);"/><label for="idNombreAgente">NombreAgente</label></div></div></div></div><div role="tabpanel" class="tab-pane fade" id="tabordenarcolumnas"><div class="row"><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="card"><div class="header"><h2>Ordenar Columnas<small>Ordena las columnas arrastrándolas hacia arriba o hacia abajo. </small></h2></div><div class="body"><div class="clearfix m-b-20"><div class="dd" onchange="ordenarcolumnas()"><ol class="dd-list" id="columnasnestable"></ol></div></div><input type="hidden" id="string_datos_ordenamiento_columnas" name="string_datos_ordenamiento_columnas" class="form-control" required></div></div></div></div></div></div>'),$("#string_datos_ordenamiento_columnas").val(columnas_ordenadas),$("#string_datos_tabla_true").val(campos_activados),$("#string_datos_tabla_false").val(campos_desactivados),$("#modalconfigurartabla").modal("show"),$("#titulomodalconfiguraciontabla").html("Configuración de la tabla"),$(".dd").nestable();for(var a=campos_activados.split(","),e=0;e<a.length;e++)$("input[name='"+a[e]+"']").prop("checked",!0);var o=columnas_ordenadas.split(",");$("#columnasnestable").empty();for(e=0;e<o.length;e++){var t='<li class="dd-item nestable'+o[e]+'"><div class="dd-handle">'+o[e]+'</div><input type="hidden" class="inputnestable" value="'+o[e]+'"></li>';$("#columnasnestable").append(t)}}$("#btnGuardar").on("click",function(a){a.preventDefault();var e=new FormData($("#formparsley")[0]),o=$("#formparsley");o.parsley().isValid()?(a=$("#numerofilas").val(),0<parseInt(a)?($(".page-loader-wrapper").css("display","block"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_guardar,type:"post",dataType:"html",data:e,cache:!1,contentType:!1,processData:!1,success:function(a){msj_datosguardadoscorrectamente(),limpiar(),ocultarmodalformulario(),limpiarmodales(),$(".page-loader-wrapper").css("display","none")},error:function(a){(403==a.status?msj_errorenpermisos:msj_errorajax)(),$(".page-loader-wrapper").css("display","none")}})):msj_erroralmenosunaentrada()):msjfaltandatosporcapturar(),o.parsley().validate()}),$("#btnGuardarModificacion").on("click",function(a){a.preventDefault();var e=new FormData($("#formparsley")[0]),o=$("#formparsley");o.parsley().isValid()?(a=$("#numerofilas").val(),0<parseInt(a)?($(".page-loader-wrapper").css("display","block"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_guardar_modificacion,type:"post",dataType:"html",data:e,cache:!1,contentType:!1,processData:!1,success:function(a){msj_datosguardadoscorrectamente(),limpiar(),ocultarmodalformulario(),limpiarmodales(),$(".page-loader-wrapper").css("display","none")},error:function(a){(403==a.status?msj_errorenpermisos:msj_errorajax)(),$(".page-loader-wrapper").css("display","none")}})):msj_erroralmenosunaentrada()):msjfaltandatosporcapturar(),o.parsley().validate()}),$("#btnbaja").on("click",function(a){a.preventDefault();var e=new FormData($("#formdesactivar")[0]),a=$("#formdesactivar");a.parsley().isValid()?($(".page-loader-wrapper").css("display","block"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_alta_o_baja,type:"post",dataType:"html",data:e,cache:!1,contentType:!1,processData:!1,success:function(a){$("#estatusregistro").modal("hide"),msj_datosguardadoscorrectamente(),$("#motivobaja").val(""),$(".page-loader-wrapper").css("display","none")},error:function(a){(403==a.status?msj_errorenpermisos:msj_errorajax)(),$("#estatusregistro").modal("hide"),$(".page-loader-wrapper").css("display","none")}})):a.parsley().validate()}),$("#btnenviarpdfemail").on("click",function(a){a.preventDefault();var e=new FormData($("#formenviarpdfemail")[0]),a=$("#formenviarpdfemail");a.parsley().isValid()?($(".page-loader-wrapper").css("display","block"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_enviar_pdfs_email,type:"post",dataType:"html",data:e,cache:!1,contentType:!1,processData:!1,success:function(a){msj_documentoenviadoporemailcorrectamente(),$("#modalenviarpdfemail").modal("hide"),$(".page-loader-wrapper").css("display","none")},error:function(a){(403==a.status?msj_errorenpermisos:msj_errorajax)(),$("#modalenviarpdfemail").modal("hide"),$(".page-loader-wrapper").css("display","none")}})):a.parsley().validate()}),$("#btntimbrarfactura").on("click",function(a){a.preventDefault();var e=new FormData($("#formtimbrado")[0]),a=$("#formtimbrado");a.parsley().isValid()?($(".page-loader-wrapper").css("display","block"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_timbrar_factura,type:"post",dataType:"html",data:e,cache:!1,contentType:!1,processData:!1,success:function(a){$("#modaltimbrado").modal("hide");a=JSON.parse(a);msj_documentotimbradocorrectamente(a.mensaje,a.tipomensaje),$(".page-loader-wrapper").css("display","none")},error:function(a){(403==a.status?msj_errorenpermisos:msj_errorajax)(),$("#modaltimbrado").modal("hide"),$(".page-loader-wrapper").css("display","none")}})):a.parsley().validate()}),$("#btnbajatimbre").on("click",function(a){a.preventDefault();var e=new FormData($("#formbajatimbre")[0]),a=$("#formbajatimbre");a.parsley().isValid()?($(".page-loader-wrapper").css("display","block"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:facturas_baja_timbre,type:"post",dataType:"html",data:e,cache:!1,contentType:!1,processData:!1,success:function(a){console.log(a),$("#modalbajatimbre").modal("hide"),msj_timbrecanceladocorrectamente(),$(".page-loader-wrapper").css("display","none")},error:function(a){(403==a.status?msj_errorenpermisos:msj_errorajax)(),$("#modalbajatimbre").modal("hide"),$(".page-loader-wrapper").css("display","none")}})):a.parsley().validate()}),init();